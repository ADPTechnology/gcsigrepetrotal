import{dateRangeConfig,InitAjaxSelect2}from"./utils.js";import DataTableEs from"./datatable_es.js";import{Toast,ToastError,SwalDelete,SwalConfirm}from"./sweet_alerts.js";$(()=>{function e(e){var a=!0;return e.find(".required-input").each(function(){$(this).removeClass("required"),""==$(this).val()&&($(this).addClass("required"),a=!1)}),a}function a(){var e=!0;return $(".required-input").each(function(){$(this).removeClass("required"),""==$(this).val()&&($(this).addClass("required"),e=!1)}),e}function t(){Swal.fire({toast:!0,icon:"warning",title:"Advertencia",text:"¡Rellena el formulario para continuar!",position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.addEventListener("mouseenter",Swal.stopTimer),e.addEventListener("mouseleave",Swal.resumeTimer)}})}if($.ajaxSetup({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}}),$("#users-table").length){var n=$("#users-table"),o=n.data("url"),r=n.DataTable({responsive:!0,language:DataTableEs,ajax:o,columns:[{data:"id",name:"id"},{data:"name",name:"name"},{data:"dni",name:"dni"},{data:"phone",name:"phone"},{data:"company",name:"company"},{data:"role.name",name:"role.name"},{data:"status",name:"status"},{data:"action",name:"action",orderable:!1,searchable:!1,className:"not-export-col"}],dom:"Bfrtlip",buttons:[{text:'<i class="fa-solid fa-download"></i> &nbsp; Descargar Excel',extend:"excelHtml5",exportOptions:{columns:":not(.not-export-col)",format:{body:function(e,a,t,n){return e.toString().replace(/<br>/g,", \n").replace(/(&nbsp;|<([^>]+)>)/gi,"")}}},title:"USUARIOS_"+moment().format("YY-MM-DD_hh-mm-ss"),filename:"usuarios-general_"+moment().format("YY-MM-DD_hh-mm-ss")}]});if($("#registerProfileSelect").length){var s=$("#registerProfileSelect");s.select2({dropdownParent:$("#registerUserForm"),placeholder:"Selecciona un perfil"});var i=$("#registerCompanySelect");i.select2({dropdownParent:$("#registerUserForm"),placeholder:"Selecciona una empresa"});var d=$("#select-company-container-register");s.on("change",function(){let e=$("#RegisterUserModal");if($("#RegisterUserModal").hasClass("show")){var a=$(this).val(),t=$(this).data("url");$.ajax({type:"GET",url:t,data:{id:a,type:"approving"},dataType:"JSON",success:function(a){if(d.html(""),"applicant"==a.valid){if(!$("#selectApprovingsRegister").length){$("#selects-container-register").append('<div class="form-group col-md-12" id="selectApprovingsRegister">                                                 <label> Aprobantes (opcional)</label>                                                 <select name="id_approvings[]" class="form-control select2"                                                     multiple="multiple" id="registerApprovingsSelect">                                                 </select>                                             </div>');var n=$("#registerApprovingsSelect");n.select2({dropdownParent:$("#registerUserForm"),placeholder:"Selecciona un aprobante",closeOnSelect:!1}),n.append('<option value=""></option>')}}else $("#selectApprovingsRegister").remove();if("approver"==a.valid){d.html('<select data-url="'+t+'" name="id_user_company[]"                                                             class="form-control select2" id="registerCompanySelect" required multiple>                                                             <option></option>                                                        </select>');var o=$("#registerCompanySelect");o.select2({dropdownParent:$("#registerUserForm"),placeholder:"Selecciona una o más empresas",closeOnSelect:!1});let a=e.find("input[name=email]");a.attr("required","required"),e.find("label[for=inputEmail]").html("Email *")}else{d.html('<select data-url="'+t+'" name="id_user_company"                                                             class="form-control select2" id="registerCompanySelect" required>                                                             <option></option>                                                        </select>');o=$("#registerCompanySelect");o.select2({dropdownParent:$("#registerUserForm"),placeholder:"Selecciona una empresa"});let a=e.find("input[name=email]");a.removeAttr("required"),e.find("label[for=inputEmail]").html("Email (opcional)")}$.each(a.companies,function(e,a){o.append('<option value="'+a.id+'"> '+a.name+" </option>")}),1==a.validManager?($("#image-upload-register").removeAttr("required"),e.find(".info-signature-required").html("(opcional)")):($("#image-upload-register").prop("required","true"),e.find(".info-signature-required").html("*"))},error:function(e){ToastError.fire()}})}}),$("body").on("change","#registerCompanySelect",function(){if($("#RegisterUserModal").hasClass("show")&&$("#selectApprovingsRegister").length){var e=$(this).val(),a=$(this).data("url"),t=$("#registerApprovingsSelect");t.html(""),$.ajax({type:"GET",url:a,data:{id:e,type:"company"},dataType:"JSON",success:function(e){t.append("<option></option>"),$.each(e.approvings,function(e,a){t.append('<option value="'+a.id+'">'+a.name+"</option>")})},error:function(e){console.log(e)}})}})}$("#register-user-status-checkbox").change(function(){var e=$("#txt-register-description-user");this.checked?e.html("Activo"):e.html("Inactivo")}),$("#registerUserForm").on("submit",function(e){e.preventDefault();var a=$(this).find(".loadSpinner"),t=$(this).find(".img-signature-holder");a.toggleClass("active");var n=this,o=new FormData($(n)[0]);$.ajax({url:$(n).attr("action"),method:$(n).attr("method"),data:o,processData:!1,dataType:"JSON",contentType:!1,success:function(e){Swal.fire({toast:!0,icon:"success",title:"¡Usuario registrado exitosamente!",position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.addEventListener("mouseenter",Swal.stopTimer),e.addEventListener("mouseleave",Swal.resumeTimer)}}),$(t).empty(),$("#registerUserForm").trigger("reset"),$("#RegisterUserModal").modal("hide"),$("#registerProfileSelect").val("").trigger("change"),$("#select-company-container-register").html('<select data-url="" name="id_user_company"                                                                     class="form-control select2" id="registerCompanySelect" required>                                                                     <option></option>                                                                </select>');var a=$("#registerCompanySelect");a.select2({dropdownParent:$("#registerUserForm"),placeholder:"Selecciona una empresa"}),$("#selectApprovingsRegister").length&&$("#selectApprovingsRegister").remove(),r.ajax.reload(null,!1)},complete:function(e){a.toggleClass("active")},error:function(e){console.log("Error",e)}})});var l=$('input[type="file"][name="userImageSignatureRegister"]');l.val(""),l.on("change",function(){var e=$(this)[0].value,a=$(this).closest("#registerUserForm").find(".img-signature-holder"),t=e.substring(e.lastIndexOf(".")+1).toLowerCase();if("jpeg"==t||"jpg"==t||"png"==t)if("undefined"!=typeof FileReader){a.empty();var n=new FileReader;n.onload=function(e){$("<img/>",{src:e.target.result,class:"img-fluid signature_img"}).appendTo(a)},a.show(),n.readAsDataURL($(this)[0].files[0])}else $(a).html("Este navegador no soporta Lector de Archivos");else l.val(""),$(a).empty(),Swal.fire({toast:!0,icon:"warning",title:"¡Selecciona una imagen!",position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.addEventListener("mouseenter",Swal.stopTimer),e.addEventListener("mouseleave",Swal.resumeTimer)}})}),$(".main-content").on("click",".deleteUser",function(){var e=$(this).data("url");Swal.fire({title:"¿Estás seguro?",text:"¡Esta acción no podrá ser revertida!",icon:"warning",showCancelButton:!0,confirmButtonText:"¡Sí!",cancelButtonText:"Cancelar",reverseButtons:!0}).then(function(a){!0===a.value?$.ajax({type:"DELETE",url:e,dataType:"JSON",success:function(e){!0===e.success?(r.ajax.reload(null,!1),Swal.fire({toast:!0,icon:"success",title:"Registro eliminado",position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.addEventListener("mouseenter",Swal.stopTimer),e.addEventListener("mouseleave",Swal.resumeTimer)}})):Swal.fire({toast:!0,icon:"error",title:"¡Ocurrió un error inesperado!",position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.addEventListener("mouseenter",Swal.stopTimer),e.addEventListener("mouseleave",Swal.resumeTimer)}})},error:function(e){console.log("Error",e)}}):a.dismiss},function(e){return!1})});var c=$("#editCompanySelect");c.select2({dropdownParent:$("#EditUserForm"),placeholder:"Selecciona una empresa"}),$("#edit-user-status-checkbox").change(function(){var e=$("#txt-edit-description-user");this.checked?e.html("Activo"):e.html("Inactivo")}),$("html").on("click",".editUser",function(e){e.preventDefault();var a=$(this).data("url"),t=$(this).data("send"),n=$("#EditUserModal"),o=n.find("#profile-show-edit");n.find("#image-signature-edit").remove(),n.find("#EditUserForm").attr("action",a),o.html(""),n.find("#inputPasswordEdit").val(""),c.html("").attr("name","id_user_company"),c.select2({dropdownParent:$("#EditUserForm"),placeholder:"Selecciona una empresa",multiple:!1}),$.ajax({type:"GET",url:t,dataType:"JSON",success:function(e){var a=e.status;let t=n.find("input[name=email]"),r=e.selectedCompanies,s=$.map(r,function(e,a){return e.id});if("applicant"==e.validApplicant){$("#selects-container-edit").append('<div class="form-group col-md-12" id="selectApprovingsEdit">                                     <label> Aprobantes (opcional)</label>                                     <select name="id_approvings[]" class="form-control select2"                                         multiple="multiple" id="editApprovingsSelect">                                     </select>                                 </div>');var i=$("#editApprovingsSelect");i.select2({dropdownParent:$("#EditUserForm"),placeholder:"Selecciona un aprobante",closeOnSelect:!1}),i.append("<option></option>"),$.each(e.approvings,function(e,a){i.append('<option value="'+a.id+'">'+a.name+"</option>")}),i.val(e.selectedApprovings).change()}else $("#selectApprovingsEdit").length&&$("#selectApprovingsEdit").remove();"approver"==e.validApplicant?(t.attr("required","required"),n.find("label[for=inputEmail]").html("Email *"),c.attr("name","id_user_company[]"),c.select2({dropdownParent:$("#EditUserForm"),placeholder:"Selecciona una o más empresa",closeOnSelect:!1,multiple:!0})):(t.removeAttr("required"),n.find("label[for=inputEmail]").html("Email (opcional)")),n.find("#inputUserName").val(e.username),n.find("#inputName").val(e.name),n.find("input[name=dni]").val(e.dni),n.find("#inputEmail").val(e.email),n.find("#inputPhone").val(e.phone),n.find("#inputComment").val(e.comment),n.find("#txt-last-login").html(e.last_login),n.find(".img-signature-holder").html('<img class="img-fluid signature_img" id="image-signature-edit" src="'+e.url_signature+'"></img>'),n.find("#image-upload-edit").attr("data-value",'<img scr="'+e.url_signature+'" class="img-fluid signature_img"'),n.find("#image-upload-edit").val(""),o.html(e.profile),c.append("<option></option>"),$.each(e.companies,function(e,a){c.append('<option value="'+a.id+'">'+a.name+"</option>")}),c.val(s).change(),1==a?(n.find("#edit-user-status-checkbox").prop("checked",!0),$("#txt-edit-description-user").html("Activo")):(n.find("#edit-user-status-checkbox").prop("checked",!1),$("#txt-edit-description-user").html("Inactivo")),1==e.is_admin?(n.find("#edit-user-status-checkbox").prop("disabled",!0),n.find(".custom-switch-indicator").addClass("disabled")):(n.find("#edit-user-status-checkbox").prop("disabled",!1),n.find(".custom-switch-indicator").removeClass("disabled"))},error:function(e){console.log(e)},complete:function(e){n.modal("show")}})});var m=$('input[type="file"][name="userImageSignatureEdit"]');m.val(""),m.on("change",function(){var e=$(this)[0].value,a=$(this).closest("#EditUserForm").find(".img-signature-holder"),t=$(this).data("value"),n=e.substring(e.lastIndexOf(".")+1).toLowerCase();if("jpeg"==n||"jpg"==n||"png"==n)if("undefined"!=typeof FileReader){a.empty();var o=new FileReader;o.onload=function(e){$("<img/>",{src:e.target.result,class:"img-fluid signature_img"}).appendTo(a)},a.show(),o.readAsDataURL($(this)[0].files[0])}else $(a).html("Este navegador no soporta Lector de Archivos");else m.val(""),$(a).html(t),Swal.fire({toast:!0,icon:"warning",title:"¡Selecciona una imagen!",position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.addEventListener("mouseenter",Swal.stopTimer),e.addEventListener("mouseleave",Swal.resumeTimer)}})}),$("#EditUserForm").on("submit",function(e){e.preventDefault();var a=$(this).find(".loadSpinner");a.toggleClass("active");var t=this;$.ajax({url:$(this).attr("action"),method:$(this).attr("method"),data:new FormData($(t)[0]),processData:!1,dataType:"JSON",contentType:!1,success:function(e){Swal.fire({toast:!0,icon:"success",title:"¡Usuario actualizado exitosamente!",position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.addEventListener("mouseenter",Swal.stopTimer),e.addEventListener("mouseleave",Swal.resumeTimer)}}),$("#EditUserModal").modal("hide"),r.ajax.reload(null,!1)},complete:function(e){a.toggleClass("active")},error:function(e){console.log("Error",e)}})}),$("#EditUserModal").on("hide.bs.modal",function(e){$("#selectApprovingsEdit").length&&$("#selectApprovingsEdit").remove()})}if($("#warehouses-table").length){$("#registerLotSelect").length&&($("#registerLotSelect").select2({dropdownParent:$("#registerWarehouseForm"),placeholder:"Selecciona un lote"}),$("#registerLocationSelect").select2({dropdownParent:$("#registerWarehouseForm"),placeholder:"Selecciona una locación"}),$("#registerProjectSelect").select2({dropdownParent:$("#registerWarehouseForm"),placeholder:"Selecciona una área / proyecto"}),$("#registerCompanySelect").select2({dropdownParent:$("#registerWarehouseForm"),placeholder:"Selecciona una empresa"}),$("#editLotSelect").select2({dropdownParent:$("#editWarehouseForm"),placeholder:"Selecciona un lote"}),$("#editLocationSelect").select2({dropdownParent:$("#editWarehouseForm"),placeholder:"Selecciona una locación"}),$("#editProjectSelect").select2({dropdownParent:$("#editWarehouseForm"),placeholder:"Selecciona una área / proyecto"}),$("#editCompanySelect").select2({dropdownParent:$("#editWarehouseForm"),placeholder:"Selecciona una empresa"}));var u=$("#warehouses-table"),p=u.data("url"),g=u.DataTable({responsive:!0,language:DataTableEs,ajax:{url:p,data:{table:"warehouse"}},columns:[{data:"id",name:"id"},{data:"name",name:"name"},{data:"lot.name",name:"lot.name"},{data:"location.name",name:"location.name"},{data:"activity",name:"activity"},{data:"project_area.name",name:"projectArea.name"},{data:"company.name",name:"company.name"},{data:"code",name:"code"},{data:"action",name:"action",orderable:!1,searchable:!1,className:"not-export-col"}],dom:"Bfrtlip",buttons:[{text:'<i class="fa-solid fa-download"></i> &nbsp; Descargar Excel',extend:"excelHtml5",exportOptions:{columns:":not(.not-export-col)"},title:"PUNTOS VERDES_"+moment().format("YY-MM-DD_hh-mm-ss"),filename:"puntos-verdes_"+moment().format("YY-MM-DD_hh-mm-ss")}]});$("#registerActivitySelect").select2({dropdownParent:$("#registerWarehouseForm"),placeholder:"Selecciona una actividad"}),$("#registerWarehouseBtn").on("click",function(e){var a=$("#RegisterWarehouseModal"),t=a.find("#registerLotSelect"),n=a.find("#registerStageSelect"),o=a.find("#registerLocationSelect"),r=a.find("#registerProjectSelect"),s=a.find("#registerCompanySelect"),i=a.find("#registerFrontSelect"),d=$(this),l=d.data("url"),c=d.find(".loadSpinner");c.toggleClass("active"),t.html(""),n.html(""),o.html(""),r.html(""),s.html(""),i.html(""),$.ajax({type:"GET",url:l,dataType:"JSON",success:function(e){t.append('<option value=""></option>'),$.each(e.lots,function(e,a){t.append('<option value="'+a.id+'">'+a.name+"</option>")}),n.append('<option value=""></option>'),$.each(e.stages,function(e,a){n.append('<option value="'+a.id+'">'+a.name+"</option>")}),o.append('<option value=""></option>'),$.each(e.locations,function(e,a){o.append('<option value="'+a.id+'">'+a.name+"</option>")}),r.append('<option value=""></option>'),$.each(e.projects,function(e,a){r.append('<option value="'+a.id+'">'+a.name+"</option>")}),s.append('<option value=""></option>'),$.each(e.companies,function(e,a){s.append('<option value="'+a.id+'">'+a.name+"</option>")}),i.append('<option value=""></option>'),$.each(e.fronts,function(e,a){i.append('<option value="'+a.id+'">'+a.name+"</option>")}),c.toggleClass("active"),a.modal("show")}})});$("#registerWarehouseForm").validate({rules:{name:{required:!0,maxlength:255,remote:{url:$("#registerWarehouseForm").data("validate"),method:$("#registerWarehouseForm").attr("method"),dataType:"JSON",data:{name:function(){return $("#registerWarehouseForm").find("input[name=name]").val()}}}},code:{required:!0,maxlength:255},activity:{required:!0},id_lot:{required:!0},id_project_area:{required:!0},id_company:{required:!0}},messages:{name:{remote:"Este nombre ya está registrado"}},submitHandler:function(e,a){a.preventDefault();e=$(e);var t=e.find(".loadSpinner");t.toggleClass("active");var n=e.serialize();$.ajax({url:e.attr("action"),method:e.attr("method"),data:n,dataType:"JSON",success:function(e){Swal.fire({toast:!0,icon:"success",title:"¡Punto verde registrado exitosamente!",position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.addEventListener("mouseenter",Swal.stopTimer),e.addEventListener("mouseleave",Swal.resumeTimer)}}),$("#RegisterWarehouseModal").modal("hide"),g.ajax.reload()},complete:function(e){t.toggleClass("active")}})}});$("#editActivitySelect").select2({dropdownParent:$("#editWarehouseForm"),placeholder:"Selecciona una actividad"}),$("html").on("click",".editWarehouse",function(){var e=$(this).data("send"),a=$(this).data("url"),t=$(this).data("id"),n=$("#EditWarehouseModal"),o=n.find("#editLotSelect"),r=n.find("#editStageSelect"),s=n.find("#editLocationSelect"),i=n.find("#editProjectSelect"),d=n.find("#editCompanySelect"),l=n.find("#editFrontSelect"),c=n.find("#editActivitySelect");o.html(""),r.html(""),s.html(""),i.html(""),d.html(""),l.html(""),$.ajax({type:"GET",url:e,dataType:"JSON",success:function(e){o.append('<option value=""></option>'),$.each(e.lots,function(e,a){o.append('<option value="'+a.id+'">'+a.name+"</option>")}),r.append('<option value=""></option>'),$.each(e.stages,function(e,a){r.append('<option value="'+a.id+'">'+a.name+"</option>")}),s.append('<option value=""></option>'),$.each(e.locations,function(e,a){s.append('<option value="'+a.id+'">'+a.name+"</option>")}),i.append('<option value=""></option>'),$.each(e.projects,function(e,a){i.append('<option value="'+a.id+'">'+a.name+"</option>")}),d.append('<option value=""></option>'),$.each(e.companies,function(e,a){d.append('<option value="'+a.id+'">'+a.name+"</option>")}),l.append('<option value=""></option>'),$.each(e.fronts,function(e,a){l.append('<option value="'+a.id+'">'+a.name+"</option>")});let a=e.warehouse;$.each(a,function(e,a){let t=n.find(`input[name=${e}]`);t.length&&t.val(a)}),o.val(a.id_lot).change(),r.val(a.id_stage).change(),s.val(a.id_location).change(),i.val(a.id_project_area).change(),d.val(a.id_company).change(),l.val(a.id_front).change(),c.val(a.activity).trigger("change"),n.modal("show")}}),$("#editWarehouseForm").attr("action",a),$("#editWarehouseForm").attr("data-id",t)});$("#editWarehouseForm").validate({rules:{name:{required:!0,maxlength:255,remote:{url:$("#editWarehouseForm").data("validate"),method:$("#editWarehouseForm").attr("method"),dataType:"JSON",data:{name:function(){return $("#editWarehouseForm").find("input[name=name]").val()},id:function(){return $("#editWarehouseForm").attr("data-id")}}}},code:{required:!0,maxlength:255},activity:{required:!0},id_lot:{required:!0},id_project_area:{required:!0},id_company:{required:!0}},messages:{name:{remote:"Este nombre ya está registrado"}},submitHandler:function(e,a){a.preventDefault();e=$(e);var t=e.find(".loadSpinner");t.toggleClass("active"),$.ajax({url:e.attr("action"),method:e.attr("method"),data:e.serialize(),dataType:"JSON",success:function(e){Swal.fire({toast:!0,icon:"success",title:"¡Punto verde actualizado exitosamente!",position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.addEventListener("mouseenter",Swal.stopTimer),e.addEventListener("mouseleave",Swal.resumeTimer)}}),$("#EditWarehouseModal").modal("hide"),g.ajax.reload(null,!1)},complete:function(e){t.toggleClass("active")},error:function(e){console.log("Error",e)}})}});var f,h,v,w,b,_;$("html").on("click",".deleteWarehouse",function(){var e=$(this).data("url");Swal.fire({title:"¿Estás seguro?",text:"¡Esta acción no podrá ser revertida!",icon:"warning",showCancelButton:!0,confirmButtonText:"¡Sí!",cancelButtonText:"Cancelar",reverseButtons:!0}).then(function(a){!0===a.value?$.ajax({type:"DELETE",url:e,dataType:"JSON",success:function(e){1==e.success?(g.ajax.reload(null,!1),Swal.fire({toast:!0,icon:"success",title:"Registro eliminado",position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.addEventListener("mouseenter",Swal.stopTimer),e.addEventListener("mouseleave",Swal.resumeTimer)}})):"invalid"==e.success&&Swal.fire({toast:!0,icon:"error",title:"Error: Este punto de acopio está relacionado a una guía de internamiento",position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.addEventListener("mouseenter",Swal.stopTimer),e.addEventListener("mouseleave",Swal.resumeTimer)}})},error:function(e){console.log("Error",e)}}):a.dismiss},function(e){return!1})}),$("#lots-tab").on("click",function(){if(!$("#lots-table_wrapper").length){var e=$("#lots-table"),a=e.data("url");f=e.DataTable({language:DataTableEs,ajax:{url:a,data:{table:"lot"}},columns:[{data:"id",name:"id"},{data:"name",name:"name"},{data:"action",name:"action",orderable:!1,searchable:!1,className:"not-export-col"}],dom:"Bfrtlip",buttons:[{text:'<i class="fa-solid fa-download"></i> &nbsp; Descargar Excel',extend:"excelHtml5",exportOptions:{columns:":not(.not-export-col)"},title:"LOTES_"+moment().format("YY-MM-DD_hh-mm-ss"),filename:"lotes_"+moment().format("YY-MM-DD_hh-mm-ss")}]})}}),$("#RegisterLotsModal").on("show.bs.modal",function(e){var a=$(e.relatedTarget),t=a.data("url"),n=a.data("text"),o=a.data("placeholder"),r=$(this),s=r.find("#registerLotForm");s.attr("action",t),r.find("#txt-context-element").html(n),r.find("#inputName").attr("placeholder",o)}),$("#btn-save-lot").on("click",function(e){e.preventDefault();var a=$("#registerLotForm"),n=!0;if(a.find(".required-input").each(function(){$(this).removeClass("required"),""==$(this).val()&&($(this).addClass("required"),n=!1)}),n){var o=a.find(".loadSpinner");o.toggleClass("active");var r=a.serialize();$.ajax({url:a.attr("action"),method:a.attr("method"),data:r,dataType:"JSON",success:function(e){Swal.fire({toast:!0,icon:"success",title:"¡Registrado exitosamente!",position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.addEventListener("mouseenter",Swal.stopTimer),e.addEventListener("mouseleave",Swal.resumeTimer)}}),o.toggleClass("active"),a.trigger("reset"),$("#RegisterLotsModal").modal("hide"),f.ajax.reload()},error:function(e){console.log("Error",e)}})}else t()}),$("#EditLotModal").on("show.bs.modal",function(e){var a=$(e.relatedTarget),t=a.data("url"),n=a.data("send"),o=$(this);$.ajax({type:"GET",url:n,dataType:"JSON",success:function(e){o.find("#inputName").val(e.name)}}),o.find("#editLotsForm").attr("action",t)}),$("#editLotsForm").on("submit",function(e){e.preventDefault();var a=$(this).find(".loadSpinner");a.toggleClass("active");var t=this;$.ajax({url:$(this).attr("action"),method:$(this).attr("method"),data:$(t).serialize(),dataType:"JSON",success:function(e){Swal.fire({toast:!0,icon:"success",title:"¡Lote actualizado exitosamente!",position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.addEventListener("mouseenter",Swal.stopTimer),e.addEventListener("mouseleave",Swal.resumeTimer)}}),a.toggleClass("active"),$("#EditLotModal").modal("hide"),f.ajax.reload()},error:function(e){console.log("Error",e)}})}),$(".main-content").on("click",".deleteLot",function(){var e=$(this).data("url");Swal.fire({title:"¿Estás seguro?",text:"¡Esta acción no podrá ser revertida!",icon:"warning",showCancelButton:!0,confirmButtonText:"¡Sí!",cancelButtonText:"Cancelar",reverseButtons:!0}).then(function(a){!0===a.value?$.ajax({type:"DELETE",url:e,dataType:"JSON",success:function(e){1==e.success?(f.ajax.reload(),Swal.fire({toast:!0,icon:"success",title:"Registro eliminado",position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.addEventListener("mouseenter",Swal.stopTimer),e.addEventListener("mouseleave",Swal.resumeTimer)}})):"invalid"==e.success&&Swal.fire({toast:!0,icon:"error",title:"Error: Este Lote está relacionado a un punto de acopio",position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.addEventListener("mouseenter",Swal.stopTimer),e.addEventListener("mouseleave",Swal.resumeTimer)}})},error:function(e){console.log("Error",e)}}):a.dismiss},function(e){return!1})}),$("#stages-tab").on("click",function(){if(!$("#stage-table_wrapper").length){var e=$("#stage-table"),a=e.data("url");h=e.DataTable({language:DataTableEs,ajax:{url:a,data:{table:"stage"}},columns:[{data:"id",name:"id"},{data:"name",name:"name"},{data:"action",name:"action",orderable:!1,searchable:!1,className:"not-export-col"}],dom:"Bfrtlip",buttons:[{text:'<i class="fa-solid fa-download"></i> &nbsp; Descargar Excel',extend:"excelHtml5",exportOptions:{columns:":not(.not-export-col)"},title:"ETAPAS_"+moment().format("YY-MM-DD_hh-mm-ss"),filename:"etapas_"+moment().format("YY-MM-DD_hh-mm-ss")}]})}}),$("#RegisterStagesModal").on("show.bs.modal",function(e){var a=$(e.relatedTarget),t=a.data("url"),n=a.data("text"),o=a.data("placeholder"),r=$(this),s=r.find("#registerStageForm");s.attr("action",t),r.find("#txt-context-element").html(n),r.find("#inputName").attr("placeholder",o)}),$("#btn-save-stage").on("click",function(e){e.preventDefault();var a=$("#registerStageForm"),n=!0;if(a.find(".required-input").each(function(){$(this).removeClass("required"),""==$(this).val()&&($(this).addClass("required"),n=!1)}),n){var o=a.find(".loadSpinner");o.toggleClass("active");var r=a.serialize();$.ajax({url:a.attr("action"),method:a.attr("method"),data:r,dataType:"JSON",success:function(e){Swal.fire({toast:!0,icon:"success",title:"¡Registrado exitosamente!",position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.addEventListener("mouseenter",Swal.stopTimer),e.addEventListener("mouseleave",Swal.resumeTimer)}}),o.toggleClass("active"),a.trigger("reset"),$("#RegisterStagesModal").modal("hide"),h.ajax.reload()},error:function(e){console.log("Error",e)}})}else t()}),$("#EditStageModal").on("show.bs.modal",function(e){var a=$(e.relatedTarget),t=a.data("url"),n=a.data("send"),o=$(this);$.ajax({type:"GET",url:n,dataType:"JSON",success:function(e){o.find("#inputStageName").val(e.name)}}),o.find("#editStageForm").attr("action",t)}),$("#editStageForm").on("submit",function(e){e.preventDefault();var a=$(this).find(".loadSpinner");a.toggleClass("active");var t=this;$.ajax({url:$(this).attr("action"),method:$(this).attr("method"),data:$(t).serialize(),dataType:"JSON",success:function(e){Swal.fire({toast:!0,icon:"success",title:"¡Etapa actualizada exitosamente!",position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.addEventListener("mouseenter",Swal.stopTimer),e.addEventListener("mouseleave",Swal.resumeTimer)}}),a.toggleClass("active"),$("#EditStageModal").modal("hide"),h.ajax.reload()},error:function(e){console.log("Error",e)}})}),$(".main-content").on("click",".deleteStage",function(){var e=$(this).data("url");Swal.fire({title:"¿Estás seguro?",text:"¡Esta acción no podrá ser revertida!",icon:"warning",showCancelButton:!0,confirmButtonText:"¡Sí!",cancelButtonText:"Cancelar",reverseButtons:!0}).then(function(a){!0===a.value?$.ajax({type:"DELETE",url:e,dataType:"JSON",success:function(e){1==e.success?(h.ajax.reload(),Swal.fire({toast:!0,icon:"success",title:"Registro eliminado",position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.addEventListener("mouseenter",Swal.stopTimer),e.addEventListener("mouseleave",Swal.resumeTimer)}})):"invalid"==e.success&&Swal.fire({toast:!0,icon:"error",title:"Error: Este registro está relacionado a un punto de acopio",position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.addEventListener("mouseenter",Swal.stopTimer),e.addEventListener("mouseleave",Swal.resumeTimer)}})},error:function(e){console.log("Error",e)}}):a.dismiss},function(e){return!1})}),$("#locations-tab").on("click",function(){if(!$("#location-table_wrapper").length){var e=$("#location-table"),a=e.data("url");v=e.DataTable({language:DataTableEs,ajax:{url:a,data:{table:"location"}},columns:[{data:"id",name:"id"},{data:"name",name:"name"},{data:"action",name:"action",orderable:!1,searchable:!1,className:"not-export-col"}],dom:"Bfrtlip",buttons:[{text:'<i class="fa-solid fa-download"></i> &nbsp; Descargar Excel',extend:"excelHtml5",exportOptions:{columns:":not(.not-export-col)"},title:"Locaciones_"+moment().format("YY-MM-DD_hh-mm-ss"),filename:"locaciones_"+moment().format("YY-MM-DD_hh-mm-ss")}]})}}),$("#RegisterLocationsModal").on("show.bs.modal",function(e){var a=$(e.relatedTarget),t=a.data("url"),n=a.data("text"),o=a.data("placeholder"),r=$(this),s=r.find("#registerLocationForm");s.attr("action",t),r.find("#txt-context-element").html(n),r.find("#inputName").attr("placeholder",o)}),$("#btn-save-location").on("click",function(e){e.preventDefault();var a=$("#registerLocationForm"),n=!0;if(a.find(".required-input").each(function(){$(this).removeClass("required"),""==$(this).val()&&($(this).addClass("required"),n=!1)}),n){var o=a.find(".loadSpinner");o.toggleClass("active");var r=a.serialize();$.ajax({url:a.attr("action"),method:a.attr("method"),data:r,dataType:"JSON",success:function(e){Swal.fire({toast:!0,icon:"success",title:"¡Registrado exitosamente!",position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.addEventListener("mouseenter",Swal.stopTimer),e.addEventListener("mouseleave",Swal.resumeTimer)}}),o.toggleClass("active"),a.trigger("reset"),$("#RegisterLocationsModal").modal("hide"),v.ajax.reload()},error:function(e){console.log("Error",e)}})}else t()}),$("#EditLocationModal").on("show.bs.modal",function(e){var a=$(e.relatedTarget),t=a.data("url"),n=a.data("send"),o=$(this);$.ajax({type:"GET",url:n,dataType:"JSON",success:function(e){o.find("#inputLocationName").val(e.name)}}),o.find("#editLocationForm").attr("action",t)}),$("#editLocationForm").on("submit",function(e){e.preventDefault();var a=$(this).find(".loadSpinner");a.toggleClass("active");var t=this;$.ajax({url:$(this).attr("action"),method:$(this).attr("method"),data:$(t).serialize(),dataType:"JSON",success:function(e){Swal.fire({toast:!0,icon:"success",title:"¡Locación actualizada exitosamente!",position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.addEventListener("mouseenter",Swal.stopTimer),e.addEventListener("mouseleave",Swal.resumeTimer)}}),a.toggleClass("active"),$("#EditLocationModal").modal("hide"),v.ajax.reload()},error:function(e){console.log("Error",e)}})}),$(".main-content").on("click",".deleteLocation",function(){var e=$(this).data("url");Swal.fire({title:"¿Estás seguro?",text:"¡Esta acción no podrá ser revertida!",icon:"warning",showCancelButton:!0,confirmButtonText:"¡Sí!",cancelButtonText:"Cancelar",reverseButtons:!0}).then(function(a){!0===a.value?$.ajax({type:"DELETE",url:e,dataType:"JSON",success:function(e){
1==e.success?(v.ajax.reload(),Swal.fire({toast:!0,icon:"success",title:"Registro eliminado",position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.addEventListener("mouseenter",Swal.stopTimer),e.addEventListener("mouseleave",Swal.resumeTimer)}})):"invalid"==e.success&&Swal.fire({toast:!0,icon:"error",title:"Error: Este registro está relacionado a un punto de acopio",position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.addEventListener("mouseenter",Swal.stopTimer),e.addEventListener("mouseleave",Swal.resumeTimer)}})},error:function(e){console.log("Error",e)}}):a.dismiss},function(e){return!1})}),$("#projects-tab").on("click",function(){if(!$("#project-table_wrapper").length){var e=$("#project-table"),a=e.data("url");w=e.DataTable({language:DataTableEs,ajax:{url:a,data:{table:"project"}},columns:[{data:"id",name:"id"},{data:"name",name:"name"},{data:"action",name:"action",orderable:!1,searchable:!1,className:"not-export-col"}],dom:"Bfrtlip",buttons:[{text:'<i class="fa-solid fa-download"></i> &nbsp; Descargar Excel',extend:"excelHtml5",exportOptions:{columns:":not(.not-export-col)"},title:"ÁREA-PROYECTO_"+moment().format("YY-MM-DD_hh-mm-ss"),filename:"area-proyecto_"+moment().format("YY-MM-DD_hh-mm-ss")}]})}}),$("#RegisterProjectsModal").on("show.bs.modal",function(e){var a=$(e.relatedTarget),t=a.data("url"),n=a.data("text"),o=a.data("placeholder"),r=$(this),s=r.find("#registerProjectForm");s.attr("action",t),r.find("#txt-context-element").html(n),r.find("#inputName").attr("placeholder",o)}),$("#btn-save-project").on("click",function(e){e.preventDefault();var a=$("#registerProjectForm"),n=!0;if(a.find(".required-input").each(function(){$(this).removeClass("required"),""==$(this).val()&&($(this).addClass("required"),n=!1)}),n){var o=a.find(".loadSpinner");o.toggleClass("active");var r=a.serialize();$.ajax({url:a.attr("action"),method:a.attr("method"),data:r,dataType:"JSON",success:function(e){Swal.fire({toast:!0,icon:"success",title:"¡Registrado exitosamente!",position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.addEventListener("mouseenter",Swal.stopTimer),e.addEventListener("mouseleave",Swal.resumeTimer)}}),o.toggleClass("active"),a.trigger("reset"),$("#RegisterProjectsModal").modal("hide"),w.ajax.reload()},error:function(e){console.log("Error",e)}})}else t()}),$("#EditProjectModal").on("show.bs.modal",function(e){var a=$(e.relatedTarget),t=a.data("url"),n=a.data("send"),o=$(this);$.ajax({type:"GET",url:n,dataType:"JSON",success:function(e){o.find("#inputProjectName").val(e.name)}}),o.find("#editProjectForm").attr("action",t)}),$("#editProjectForm").on("submit",function(e){e.preventDefault();var a=$(this).find(".loadSpinner");a.toggleClass("active");var t=this;$.ajax({url:$(this).attr("action"),method:$(this).attr("method"),data:$(t).serialize(),dataType:"JSON",success:function(e){Swal.fire({toast:!0,icon:"success",title:"¡Área de proyecto actualizada exitosamente!",position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.addEventListener("mouseenter",Swal.stopTimer),e.addEventListener("mouseleave",Swal.resumeTimer)}}),a.toggleClass("active"),$("#EditProjectModal").modal("hide"),w.ajax.reload()},error:function(e){console.log("Error",e)}})}),$(".main-content").on("click",".deleteProject",function(){var e=$(this).data("url");Swal.fire({title:"¿Estás seguro?",text:"¡Esta acción no podrá ser revertida!",icon:"warning",showCancelButton:!0,confirmButtonText:"¡Sí!",cancelButtonText:"Cancelar",reverseButtons:!0}).then(function(a){!0===a.value?$.ajax({type:"DELETE",url:e,dataType:"JSON",success:function(e){1==e.success?(w.ajax.reload(),Swal.fire({toast:!0,icon:"success",title:"Registro eliminado",position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.addEventListener("mouseenter",Swal.stopTimer),e.addEventListener("mouseleave",Swal.resumeTimer)}})):"invalid"==e.success&&Swal.fire({toast:!0,icon:"error",title:"Error: Este registro está relacionado a un punto de acopio",position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.addEventListener("mouseenter",Swal.stopTimer),e.addEventListener("mouseleave",Swal.resumeTimer)}})},error:function(e){console.log("Error",e)}}):a.dismiss},function(e){return!1})}),$("#companies-tab").on("click",function(){if(!$("#company-table_wrapper").length){var e=$("#company-table"),a=e.data("url");b=e.DataTable({language:DataTableEs,ajax:{url:a,data:{table:"company"}},columns:[{data:"id",name:"id"},{data:"name",name:"name"},{data:"ruc",name:"ruc"},{data:"action",name:"action",orderable:!1,searchable:!1,className:"not-export-col"}],dom:"Bfrtlip",buttons:[{text:'<i class="fa-solid fa-download"></i> &nbsp; Descargar Excel',extend:"excelHtml5",exportOptions:{columns:":not(.not-export-col)"},title:"EMPRESAS_"+moment().format("YY-MM-DD_hh-mm-ss"),filename:"empresas_"+moment().format("YY-MM-DD_hh-mm-ss")}]})}}),$("#RegisterCompaniesModal").on("show.bs.modal",function(e){var a=$(e.relatedTarget),t=a.data("url"),n=a.data("text"),o=a.data("placeholder"),r=$(this),s=r.find("#registerCompanyForm");s.attr("action",t),r.find("#txt-context-element").html(n),r.find("#inputName").attr("placeholder",o)}),$("#btn-save-company").on("click",function(e){e.preventDefault();var a=$("#registerCompanyForm"),n=!0;if(a.find(".required-input").each(function(){$(this).removeClass("required"),""==$(this).val()&&($(this).addClass("required"),n=!1)}),n){var o=a.find(".loadSpinner");o.toggleClass("active");var r=a.serialize();$.ajax({url:a.attr("action"),method:a.attr("method"),data:r,dataType:"JSON",success:function(e){Swal.fire({toast:!0,icon:"success",title:"¡Registrado exitosamente!",position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.addEventListener("mouseenter",Swal.stopTimer),e.addEventListener("mouseleave",Swal.resumeTimer)}}),o.toggleClass("active"),a.trigger("reset"),$("#RegisterCompaniesModal").modal("hide"),b.ajax.reload()},error:function(e){console.log("Error",e)}})}else t()}),$("#EditCompanyModal").on("show.bs.modal",function(e){var a=$(e.relatedTarget),t=a.data("url"),n=a.data("send"),o=$(this);$.ajax({type:"GET",url:n,dataType:"JSON",success:function(e){o.find("#inputCompanyName").val(e.name),o.find("#inputCompanyRuc").val(e.ruc)}}),o.find("#editCompanyForm").attr("action",t)}),$("#editCompanyForm").on("submit",function(e){e.preventDefault();var a=$(this).find(".loadSpinner");a.toggleClass("active");var t=this;$.ajax({url:$(this).attr("action"),method:$(this).attr("method"),data:$(t).serialize(),dataType:"JSON",success:function(e){Swal.fire({toast:!0,icon:"success",title:"¡Empresa actualizada exitosamente!",position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.addEventListener("mouseenter",Swal.stopTimer),e.addEventListener("mouseleave",Swal.resumeTimer)}}),a.toggleClass("active"),$("#EditCompanyModal").modal("hide"),b.ajax.reload()},error:function(e){console.log("Error",e)}})}),$(".main-content").on("click",".deleteCompany",function(){var e=$(this).data("url");Swal.fire({title:"¿Estás seguro?",text:"¡Esta acción no podrá ser revertida!",icon:"warning",showCancelButton:!0,confirmButtonText:"¡Sí!",cancelButtonText:"Cancelar",reverseButtons:!0}).then(function(a){!0===a.value?$.ajax({type:"DELETE",url:e,dataType:"JSON",success:function(e){1==e.success?(b.ajax.reload(),Swal.fire({toast:!0,icon:"success",title:"Registro eliminado",position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.addEventListener("mouseenter",Swal.stopTimer),e.addEventListener("mouseleave",Swal.resumeTimer)}})):"invalid"==e.success&&Swal.fire({toast:!0,icon:"error",title:"Error: Este registro está relacionado a un punto de acopio",position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.addEventListener("mouseenter",Swal.stopTimer),e.addEventListener("mouseleave",Swal.resumeTimer)}})},error:function(e){console.log("Error",e)}}):a.dismiss},function(e){return!1})}),$("#fronts-tab").on("click",function(){if(!$("#front-table_wrapper").length){var e=$("#front-table"),a=e.data("url");_=e.DataTable({language:DataTableEs,ajax:{url:a,data:{table:"front"}},columns:[{data:"id",name:"id"},{data:"name",name:"name"},{data:"action",name:"action",orderable:!1,searchable:!1,className:"not-export-col"}],dom:"Bfrtlip",buttons:[{text:'<i class="fa-solid fa-download"></i> &nbsp; Descargar Excel',extend:"excelHtml5",exportOptions:{columns:":not(.not-export-col)"},title:"FRENTES_"+moment().format("YY-MM-DD_hh-mm-ss"),filename:"frentes_"+moment().format("YY-MM-DD_hh-mm-ss")}]})}}),$("#RegisterFrontsModal").on("show.bs.modal",function(e){var a=$(e.relatedTarget),t=a.data("url"),n=a.data("text"),o=a.data("placeholder"),r=$(this),s=r.find("#registerFrontForm");s.attr("action",t),r.find("#txt-context-element").html(n),r.find("#inputName").attr("placeholder",o)}),$("#btn-save-front").on("click",function(e){e.preventDefault();var a=$("#registerFrontForm"),n=!0;if(a.find(".required-input").each(function(){$(this).removeClass("required"),""==$(this).val()&&($(this).addClass("required"),n=!1)}),n){var o=a.find(".loadSpinner");o.toggleClass("active");var r=a.serialize();$.ajax({url:a.attr("action"),method:a.attr("method"),data:r,dataType:"JSON",success:function(e){Swal.fire({toast:!0,icon:"success",title:"¡Registrado exitosamente!",position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.addEventListener("mouseenter",Swal.stopTimer),e.addEventListener("mouseleave",Swal.resumeTimer)}}),o.toggleClass("active"),a.trigger("reset"),$("#RegisterFrontsModal").modal("hide"),_.ajax.reload()},error:function(e){console.log("Error",e)}})}else t()}),$("#EditFrontModal").on("show.bs.modal",function(e){var a=$(e.relatedTarget),t=a.data("url"),n=a.data("send"),o=$(this);$.ajax({type:"GET",url:n,dataType:"JSON",success:function(e){o.find("#inputFrontName").val(e.name)}}),o.find("#editFrontForm").attr("action",t)}),$("#editFrontForm").on("submit",function(e){e.preventDefault();var a=$(this).find(".loadSpinner");a.toggleClass("active");var t=this;$.ajax({url:$(this).attr("action"),method:$(this).attr("method"),data:$(t).serialize(),dataType:"JSON",success:function(e){Swal.fire({toast:!0,icon:"success",title:"¡Frente actualizado exitosamente!",position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.addEventListener("mouseenter",Swal.stopTimer),e.addEventListener("mouseleave",Swal.resumeTimer)}}),a.toggleClass("active"),$("#EditFrontModal").modal("hide"),_.ajax.reload()},error:function(e){console.log("Error",e)}})}),$("html").on("click",".deleteFront",function(){var e=$(this).data("url");Swal.fire({title:"¿Estás seguro?",text:"¡Esta acción no podrá ser revertida!",icon:"warning",showCancelButton:!0,confirmButtonText:"¡Sí!",cancelButtonText:"Cancelar",reverseButtons:!0}).then(function(a){!0===a.value?$.ajax({type:"DELETE",url:e,dataType:"JSON",success:function(e){1==e.success?(_.ajax.reload(),Swal.fire({toast:!0,icon:"success",title:"Registro eliminado",position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.addEventListener("mouseenter",Swal.stopTimer),e.addEventListener("mouseleave",Swal.resumeTimer)}})):"invalid"==e.success&&Swal.fire({toast:!0,icon:"error",title:"Error: Este registro está relacionado a un punto de acopio",position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.addEventListener("mouseenter",Swal.stopTimer),e.addEventListener("mouseleave",Swal.resumeTimer)}})},error:function(e){console.log("Error",e)}}):a.dismiss},function(e){return!1})})}if($("#waste-class-table").length){var S=$("#waste-class-table"),y=(o=S.data("url"),S.DataTable({responsive:!0,language:DataTableEs,ajax:{url:o,data:{table:"class"}},columns:[{data:"id",name:"id"},{data:"group.name",name:"group.name"},{data:"status.name",name:"status.name"},{data:"symbol",name:"symbol"},{data:"types",name:"types",orderable:!1},{data:"action",name:"action",orderable:!1,searchable:!1,className:"not-export-col"}],dom:"Bfrtlip",buttons:[{text:'<i class="fa-solid fa-download"></i> &nbsp; Descargar Excel',extend:"excelHtml5",exportOptions:{format:{body:function(e,a,t,n){return e.toString().replace(/<br>/g,", \n")}},columns:":not(.not-export-col)"},title:"CLASES DE RESIDUO_"+moment().format("YY-MM-DD_hh-mm-ss"),filename:"clases-de-residuo_"+moment().format("YY-MM-DD_hh-mm-ss")}]})),D=$("#registerGroupSelect"),x=$("#registerStatusSelect");if(D.select2({placeholder:"Selecciona un grupo"}),x.select2({placeholder:"Selecciona un estado"}),$("#register-wasteClass-btn").on("click",function(e){var a=$(this),t=a.data("url"),n=$("#RegisterClassModal"),o=$("#registerWasteTypesSelect"),r=a.find(".loadSpinner");r.toggleClass("active"),o.html(""),D.html(""),x.html(""),$.ajax({type:"GET",url:t,dataType:"JSON",success:function(e){o.append('<option value=""></option>'),$.each(e.wasteTypes,function(e,a){o.append('<option value="'+a.id+'">'+a.name+"</option>")}),D.append('<option value=""></option>'),$.each(e.groups,function(e,a){D.append('<option value="'+a.id+'">'+a.name+"</option>")}),x.append('<option value=""></option>'),$.each(e.statuses,function(e,a){x.append('<option value="'+a.id+'">'+a.name+"</option>")}),r.toggleClass("active"),n.modal("show")},error:function(e){console.log(e)}})}),$("#registerWasteTypesSelect").length){var T=$("#registerWasteTypesSelect");T.select2({dropdownParent:$("#RegisterClassModal"),closeOnSelect:!1,placeholder:"Selecciona uno o más tipos de residuo"})}$("#registerWasteClassForm").validate({rules:{symbol:{required:!0,maxlength:255,remote:{url:$("#registerWasteClassForm").data("validate"),method:$("#registerWasteClassForm").attr("method"),dataType:"JSON",data:{symbol:function(){return $("#registerWasteClassForm").find("input[name=symbol]").val()}}}},group_id:{required:!0},status_id:{required:!0},"id_waste_types[]":{required:!0}},messages:{symbol:{remote:"Esta clase ya está registrada"}},submitHandler:function(e,a){a.preventDefault();e=$(e);var t=e.find(".loadSpinner");t.toggleClass("active");var n=e.serialize();$.ajax({url:e.attr("action"),method:e.attr("method"),data:n,dataType:"JSON",success:function(e){Swal.fire({toast:!0,icon:"success",title:"¡Clase registrada exitosamente!",position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.addEventListener("mouseenter",Swal.stopTimer),e.addEventListener("mouseleave",Swal.resumeTimer)}}),t.toggleClass("active"),$("#registerWasteClassForm").trigger("reset"),$("#RegisterClassModal").modal("hide"),$("#registerWasteTypesSelect").val([]).trigger("change"),y.ajax.reload()},error:function(e){console.log(e)}})}});if($("html").on("click",".deleteClass",function(){var e=$(this).data("url");Swal.fire({title:"¿Estás seguro?",text:"¡Esta acción no podrá ser revertida!",icon:"warning",showCancelButton:!0,confirmButtonText:"¡Sí!",cancelButtonText:"Cancelar",reverseButtons:!0}).then(function(a){!0===a.value?$.ajax({type:"DELETE",url:e,dataType:"JSON",success:function(e){!0===e.success?(y.ajax.reload(null,!1),Swal.fire({toast:!0,icon:"success",title:"Registro eliminado",position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.addEventListener("mouseenter",Swal.stopTimer),e.addEventListener("mouseleave",Swal.resumeTimer)}})):Swal.fire({toast:!0,icon:"error",title:"¡Ocurrió un error inesperado!",position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.addEventListener("mouseenter",Swal.stopTimer),e.addEventListener("mouseleave",Swal.resumeTimer)}})},error:function(e){console.log("Error",e)}}):a.dismiss},function(e){return!1})}),$("#editWasteTypesSelect").length){var E=$("#editWasteTypesSelect");E.select2({dropdownParent:$("#EditClassModal"),closeOnSelect:!1,placeholder:"Selecciona uno o más tipos de residuo"})}var Y=$("#editGroupSelect"),C=$("#editStatusSelect");Y.select2({placeholder:"Selecciona un grupo"}),C.select2({placeholder:"Selecciona un estado"}),$("html").on("click",".editClass",function(){var e=$(this).data("send"),a=$(this).data("url"),t=$(this).data("id"),n=$("#EditClassModal"),o=$("#editWasteTypesSelect");let r=$("#editGroupSelect"),s=$("#editStatusSelect");o.html(""),r.html(""),s.html(""),n.find("#EditWasteClassForm").attr("action",a),n.find("#EditWasteClassForm").attr("data-id",t),$.ajax({type:"GET",url:e,dataType:"JSON",success:function(e){n.find("#inputEditNameWasteClass").val(e.name),n.find("#inputSymbolWasteClass").val(e.symbol),o.append('<option value=""></option>'),$.each(e.types,function(e,a){o.append('<option value="'+a.id+'">'+a.name+"</option>")}),o.val(e.selectedTypes).trigger("change");let a=e.class;r.append('<option value=""></option>'),$.each(e.groups,function(e,a){r.append('<option value="'+a.id+'">'+a.name+"</option>")}),r.val(a.group_id).trigger("change"),s.append('<option value=""></option>'),$.each(e.statuses,function(e,a){s.append('<option value="'+a.id+'">'+a.name+"</option>")}),s.val(a.status_id).trigger("change")},error:function(e){console.log(e)},complete:function(e){n.modal("show")}})});$("#EditWasteClassForm").validate({rules:{symbol:{required:!0,maxlength:255,remote:{url:$("#EditWasteClassForm").data("validate"),method:$("#EditWasteClassForm").attr("method"),dataType:"JSON",data:{symbol:function(){return $("#EditWasteClassForm").find("input[name=symbol]").val()},id:function(){return $("#EditWasteClassForm").attr("data-id")}}}},group_id:{required:!0},status_id:{required:!0},"id_waste_types[]":{required:!0}},messages:{symbol:{remote:"Esta clase ya está registrada"}},submitHandler:function(e,a){a.preventDefault();e=$(e);var t=e.find(".loadSpinner");t.toggleClass("active"),$.ajax({url:e.attr("action"),method:e.attr("method"),data:e.serialize(),dataType:"JSON",success:function(e){Swal.fire({toast:!0,icon:"success",title:"¡Clase actualizada exitosamente!",position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.addEventListener("mouseenter",Swal.stopTimer),e.addEventListener("mouseleave",Swal.resumeTimer)}}),t.toggleClass("active"),$("#EditClassModal").modal("hide"),y.ajax.reload(null,!1)},error:function(e){console.log(e)}})}});var j=$("#groups-table"),k=j.data("url"),M=j.DataTable({responsive:!0,language:DataTableEs,ajax:{url:k},columns:[{data:"id",name:"id"},{data:"name",name:"name",className:"columnType"},{data:"action",name:"action",orderable:!1,searchable:!1,className:"btnWasteType not-export-col"}],dom:"Bfrtlip",buttons:[{text:'<i class="fa-solid fa-download"></i> &nbsp; Descargar Excel',extend:"excelHtml5",exportOptions:{columns:":not(.not-export-col)"},title:"GRUPOS_"+moment().format("YY-MM-DD_hh-mm-ss"),filename:"grupos_"+moment().format("YY-MM-DD_hh-mm-ss")}]});$("#registerGroupForm").on("submit",function(e){e.preventDefault();var a=$(this).find(".loadSpinner");a.toggleClass("active");var t=$(this);$.ajax({url:t.attr("action"),method:t.attr("method"),data:t.serialize(),dataType:"JSON",success:function(e){Swal.fire({toast:!0,icon:"success",title:"¡Tipo de residuo registrado exitosamente!",position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.addEventListener("mouseenter",Swal.stopTimer),e.addEventListener("mouseleave",Swal.resumeTimer)}}),a.toggleClass("active"),$("#registerGroupForm").trigger("reset"),M.ajax.reload()},error:function(e){console.log(e)}})}),$("#groups-table").on("click",".editGroup",function(){var e=$(this).closest("tr"),a=e.find(".btnWasteType"),t=e.find(".columnType"),n=t.text();e.addClass("edit-ready").siblings().removeClass("edit-ready"),e.siblings().find("#form-group-edit-container").remove(),e.siblings().find(".input-group-edit").remove(),a.before('<td class="input-group-edit">                         <input type="text" class="form-control" value="'+n+'" required>                     </td>'),e.append('<td id="form-group-edit-container">                         <button type="button"                                class="me-3 edit btn btn-primary btn-sm btn-update-group                                ">                                 <i class="fa-solid fa-floppy-disk"></i>                         </button>                         <button id="resetGroupEdit"                                class="ms-3 btn btn-danger btn-sm">                                 <i class="fa-solid fa-x"></i>                         </button>                     </td>')}),$("#groups-table").on("click","#resetGroupEdit",function(){var e=$(this).closest("tr");e.toggleClass("edit-ready"),e.find(".input-group-edit").remove(),$("#form-group-edit-container").remove()}),$("#groups-table").on("click",".btn-update-group",function(){var e=$(this).closest("tr"),a=e.find(".input-group-edit input").val(),t=e.find(".editGroup").data("url");0==a.length?Swal.fire({toast:!0,icon:"warning",title:"¡El campo está vacío!",position:"top-end",showConfirmButton:!1,timer:2e3,timerProgressBar:!0,didOpen:e=>{e.addEventListener("mouseenter",Swal.stopTimer),e.addEventListener("mouseleave",Swal.resumeTimer)}}):$.ajax({url:t,method:"POST",data:{value:a},dataType:"JSON",success:function(e){Swal.fire({toast:!0,icon:"success",title:"¡Registrado exitosamente!",position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.addEventListener("mouseenter",Swal.stopTimer),e.addEventListener("mouseleave",Swal.resumeTimer)}}),M.ajax.reload(null,!1)},error:function(e){console.log(e)}})}),$("#groups-table").on("click",".deleteGroup",function(){var e=$(this).data("url");Swal.fire({title:"¿Estás seguro?",text:"¡Esta acción no podrá ser revertida!",icon:"warning",showCancelButton:!0,confirmButtonText:"¡Sí!",cancelButtonText:"Cancelar",reverseButtons:!0}).then(function(a){!0===a.value?$.ajax({type:"DELETE",url:e,dataType:"JSON",success:function(e){1==e.success?(M.ajax.reload(null,!1),Swal.fire({toast:!0,icon:"success",title:"Registro eliminado",position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.addEventListener("mouseenter",Swal.stopTimer),e.addEventListener("mouseleave",Swal.resumeTimer)}})):"invalid"==e.success?Swal.fire({toast:!0,icon:"warning",title:"¡Este registro está relacionado a una o más clases de residuo, no se puede eliminar!",position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.addEventListener("mouseenter",Swal.stopTimer),e.addEventListener("mouseleave",Swal.resumeTimer)}}):Swal.fire({toast:!0,icon:"error",title:"¡Ocurrió un error inesperado!",position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.addEventListener("mouseenter",Swal.stopTimer),e.addEventListener("mouseleave",Swal.resumeTimer)}})},error:function(e){console.log("Error",e)}}):a.dismiss},function(e){return!1})});var B=$("#waste-type-table"),O=B.data("url"),L=B.DataTable({responsive:!0,language:DataTableEs,ajax:{url:O,data:{table:"type"}},columns:[{data:"id",name:"id"},{data:"name",name:"name",className:"columnType"},{data:"action",name:"action",orderable:!1,searchable:!1,className:"btnWasteType not-export-col"}],dom:"Bfrtlip",buttons:[{text:'<i class="fa-solid fa-download"></i> &nbsp; Descargar Excel',extend:"excelHtml5",exportOptions:{columns:":not(.not-export-col)"},title:"TIPOS DE RESIDUO_"+moment().format("YY-MM-DD_hh-mm-ss"),filename:"tipos-de-residuo_"+moment().format("YY-MM-DD_hh-mm-ss")}]});$("#registerWasteTypeForm").on("submit",function(e){e.preventDefault();var a=$(this).find(".loadSpinner");a.toggleClass("active");var t=$(this);$.ajax({url:t.attr("action"),method:t.attr("method"),data:t.serialize(),dataType:"JSON",success:function(e){Swal.fire({toast:!0,icon:"success",title:"¡Tipo de residuo registrado exitosamente!",position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.addEventListener("mouseenter",Swal.stopTimer),e.addEventListener("mouseleave",Swal.resumeTimer)}}),a.toggleClass("active"),$("#registerWasteTypeForm").trigger("reset"),L.ajax.reload()},error:function(e){console.log(e)}})}),$("#waste-type-table").on("click",".editType",function(){var e=$(this).closest("tr"),a=e.find(".btnWasteType"),t=e.find(".columnType"),n=t.text();e.addClass("edit-ready").siblings().removeClass("edit-ready"),e.siblings().find("#form-type-edit-container").remove(),e.siblings().find(".input-type-edit").remove(),a.before('<td class="input-type-edit">                         <input type="text" class="form-control" value="'+n+'" required>                     </td>'),e.append('<td id="form-type-edit-container">                         <button type="button"                                class="me-3 edit btn btn-primary btn-sm btn-update-waste-type                                ">                                 <i class="fa-solid fa-floppy-disk"></i>                         </button>                         <button id="resetWasteTypeEdit"                                class="ms-3 btn btn-danger btn-sm">                                 <i class="fa-solid fa-x"></i>                         </button>                     </td>')}),$("#waste-type-table").on("click","#resetWasteTypeEdit",function(){var e=$(this).closest("tr");e.toggleClass("edit-ready"),e.find(".input-type-edit").remove(),$("#form-type-edit-container").remove()}),$("#waste-type-table").on("click",".btn-update-waste-type",function(){var e=$(this).closest("tr"),a=e.find(".input-type-edit input").val(),t=e.find(".editType").data("url");0==a.length?Swal.fire({toast:!0,icon:"warning",title:"¡El campo está vacío!",position:"top-end",showConfirmButton:!1,timer:2e3,timerProgressBar:!0,didOpen:e=>{e.addEventListener("mouseenter",Swal.stopTimer),e.addEventListener("mouseleave",Swal.resumeTimer)}}):$.ajax({url:t,method:"POST",data:{value:a},dataType:"JSON",success:function(e){Swal.fire({toast:!0,icon:"success",title:"¡Registrado exitosamente!",position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.addEventListener("mouseenter",Swal.stopTimer),e.addEventListener("mouseleave",Swal.resumeTimer)}}),L.ajax.reload()},error:function(e){console.log(e)}})}),$("#waste-type-table").on("click",".deleteType",function(){var e=$(this).data("url");Swal.fire({title:"¿Estás seguro?",text:"¡Esta acción no podrá ser revertida!",icon:"warning",showCancelButton:!0,confirmButtonText:"¡Sí!",cancelButtonText:"Cancelar",reverseButtons:!0}).then(function(a){!0===a.value?$.ajax({type:"DELETE",url:e,dataType:"JSON",success:function(e){1==e.success?(L.ajax.reload(),Swal.fire({toast:!0,icon:"success",title:"Registro eliminado",position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.addEventListener("mouseenter",Swal.stopTimer),e.addEventListener("mouseleave",Swal.resumeTimer)}})):"invalid"==e.success?Swal.fire({toast:!0,icon:"warning",title:"¡Este registro está relacionado a una o más clases de residuo, no se puede eliminar!",position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.addEventListener("mouseenter",Swal.stopTimer),e.addEventListener("mouseleave",Swal.resumeTimer)}}):Swal.fire({toast:!0,icon:"error",title:"¡Ocurrió un error inesperado!",position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.addEventListener("mouseenter",Swal.stopTimer),e.addEventListener("mouseleave",Swal.resumeTimer)}})},error:function(e){console.log("Error",e)}}):a.dismiss},function(e){return!1})});var P=$("#status-table"),N=P.data("url"),F=P.DataTable({responsive:!0,language:DataTableEs,ajax:{url:N},columns:[{data:"id",name:"id"},{data:"name",name:"name",className:"columnType"},{data:"action",name:"action",orderable:!1,searchable:!1,className:"btnWasteType not-export-col"}],dom:"Bfrtlip",buttons:[{text:'<i class="fa-solid fa-download"></i> &nbsp; Descargar Excel',extend:"excelHtml5",exportOptions:{columns:":not(.not-export-col)"},title:"ESTADOS_"+moment().format("YY-MM-DD_hh-mm-ss"),filename:"estados_"+moment().format("YY-MM-DD_hh-mm-ss")}]});$("#registerStatusForm").on("submit",function(e){e.preventDefault();var a=$(this).find(".loadSpinner");a.toggleClass("active");var t=$(this);$.ajax({url:t.attr("action"),method:t.attr("method"),data:t.serialize(),dataType:"JSON",success:function(e){Swal.fire({toast:!0,icon:"success",title:"¡Tipo de residuo registrado exitosamente!",position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.addEventListener("mouseenter",Swal.stopTimer),e.addEventListener("mouseleave",Swal.resumeTimer)}}),a.toggleClass("active"),$("#registerStatusForm").trigger("reset"),F.ajax.reload()},error:function(e){console.log(e)}})}),$("#status-table").on("click",".editStatus",function(){var e=$(this).closest("tr"),a=e.find(".btnWasteType"),t=e.find(".columnType"),n=t.text();e.addClass("edit-ready").siblings().removeClass("edit-ready"),e.siblings().find("#form-status-edit-container").remove(),e.siblings().find(".input-status-edit").remove(),a.before('<td class="input-status-edit">                         <input type="text" class="form-control" value="'+n+'" required>                     </td>'),e.append('<td id="form-status-edit-container">                         <button type="button"                                class="me-3 edit btn btn-primary btn-sm btn-update-status                                ">                                 <i class="fa-solid fa-floppy-disk"></i>                         </button>                         <button id="resetStatusEdit"                                class="ms-3 btn btn-danger btn-sm">                                 <i class="fa-solid fa-x"></i>                         </button>                     </td>')}),$("#status-table").on("click","#resetStatusEdit",function(){var e=$(this).closest("tr");e.toggleClass("edit-ready"),e.find(".input-status-edit").remove(),$("#form-status-edit-container").remove()}),$("#status-table").on("click",".btn-update-status",function(){var e=$(this).closest("tr"),a=e.find(".input-status-edit input").val(),t=e.find(".editStatus").data("url");0==a.length?Swal.fire({toast:!0,icon:"warning",title:"¡El campo está vacío!",position:"top-end",showConfirmButton:!1,timer:2e3,timerProgressBar:!0,didOpen:e=>{e.addEventListener("mouseenter",Swal.stopTimer),e.addEventListener("mouseleave",Swal.resumeTimer)}}):$.ajax({url:t,method:"POST",data:{value:a},dataType:"JSON",success:function(e){Swal.fire({toast:!0,icon:"success",title:"¡Registrado exitosamente!",position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.addEventListener("mouseenter",Swal.stopTimer),e.addEventListener("mouseleave",Swal.resumeTimer)}}),F.ajax.reload(null,!1)},error:function(e){console.log(e)}})}),$("#status-table").on("click",".deleteStatus",function(){var e=$(this).data("url");Swal.fire({title:"¿Estás seguro?",text:"¡Esta acción no podrá ser revertida!",icon:"warning",showCancelButton:!0,confirmButtonText:"¡Sí!",cancelButtonText:"Cancelar",reverseButtons:!0}).then(function(a){!0===a.value?$.ajax({type:"DELETE",url:e,dataType:"JSON",success:function(e){1==e.success?(F.ajax.reload(null,!1),Swal.fire({toast:!0,icon:"success",title:"Registro eliminado",position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.addEventListener("mouseenter",Swal.stopTimer),e.addEventListener("mouseleave",Swal.resumeTimer)}})):"invalid"==e.success?Swal.fire({toast:!0,icon:"warning",title:"¡Este registro está relacionado a una o más clases de residuo, no se puede eliminar!",position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.addEventListener("mouseenter",Swal.stopTimer),e.addEventListener("mouseleave",Swal.resumeTimer)}}):Swal.fire({toast:!0,icon:"error",title:"¡Ocurrió un error inesperado!",position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.addEventListener("mouseenter",Swal.stopTimer),e.addEventListener("mouseleave",Swal.resumeTimer)}})},error:function(e){console.log("Error",e)}}):a.dismiss},function(e){return!1})})}if($("#guide-approved-table-admin").length){
var R=$("#guide-approved-table-admin");o=R.data("url"),R.DataTable({order:[[1,"desc"]],responsive:!0,language:DataTableEs,serverSide:!0,processing:!0,ajax:{url:o,data:{table:"approved"}},columns:[{data:"code",name:"code"},{data:"created_at",name:"created_at"},{data:"warehouse.lot.name",name:"warehouse.lot.name"},{data:"warehouse.stage.name",name:"warehouse.stage.name"},{data:"warehouse.location.name",name:"warehouse.location.name"},{data:"warehouse.project_area.name",name:"warehouse.projectArea.name"},{data:"warehouse.company.name",name:"warehouse.company.name"},{data:"warehouse.front.name",name:"warehouse.front.name"},{data:"stat_approved",name:"stat_approved"},{data:"stat_recieved",name:"stat_recieved"},{data:"stat_verified",name:"stat_verified"},{data:"action",name:"action",orderable:!1,searchable:!1},{data:"pdf",name:"pdf",orderable:!1,searchable:!1}]})}if($("#guide-pending-table-admin").length){var A=$("#guide-pending-table-admin"),G=(o=A.data("url"),A.DataTable({order:[[1,"desc"]],responsive:!0,language:DataTableEs,serverSide:!0,processing:!0,ajax:{url:o,data:{table:"pending"}},columns:[{data:"code",name:"code"},{data:"created_at",name:"created_at"},{data:"warehouse.lot.name",name:"warehouse.lot.name"},{data:"warehouse.stage.name",name:"warehouse.stage.name"},{data:"warehouse.location.name",name:"warehouse.location.name"},{data:"warehouse.project_area.name",name:"warehouse.projectArea.name"},{data:"warehouse.company.name",name:"warehouse.company.name"},{data:"warehouse.front.name",name:"warehouse.front.name"},{data:"stat_approved",name:"stat_approved"},{data:"stat_recieved",name:"stat_recieved"},{data:"stat_verified",name:"stat_verified"},{data:"pdf",name:"pdf",orderable:!1,searchable:!1},{data:"action",name:"action",orderable:!1,searchable:!1}]}));$("html").on("click",".delete-guide-btn",function(e){e.preventDefault();var a=$(this).attr("href");SwalDelete.fire().then(function(e){!0===e.value?$.ajax({type:"DELETE",url:a,dataType:"JSON",success:function(e){var a;!0===e.success?(G.ajax.reload(null,!1),a="success"):a="error",Toast.fire({icon:a,text:e.message})},error:function(e){console.log("Error",e)}}):e.dismiss},function(e){return!1})})}if($("#guide-rejected-table-admin").length){var J=$("#guide-rejected-table-admin"),q=(o=J.data("url"),J.DataTable({order:[[1,"desc"]],responsive:!0,language:DataTableEs,serverSide:!0,processing:!0,ajax:{url:o,data:{table:"rejected"}},columns:[{data:"code",name:"code"},{data:"created_at",name:"created_at"},{data:"warehouse.lot.name",name:"warehouse.lot.name"},{data:"warehouse.stage.name",name:"warehouse.stage.name"},{data:"warehouse.location.name",name:"warehouse.location.name"},{data:"warehouse.project_area.name",name:"warehouse.projectArea.name"},{data:"warehouse.company.name",name:"warehouse.company.name"},{data:"warehouse.front.name",name:"warehouse.front.name"},{data:"stat_approved",name:"stat_approved"},{data:"stat_recieved",name:"stat_recieved"},{data:"stat_verified",name:"stat_verified"},{data:"action",name:"action",orderable:!1,searchable:!1,className:"not-export-col text-nowrap"}]}));$("html").on("click",".delete-guide-btn",function(e){e.preventDefault();var a=$(this).attr("href");SwalDelete.fire().then(function(e){!0===e.value?$.ajax({type:"DELETE",url:a,dataType:"JSON",success:function(e){var a;!0===e.success?(q.ajax.reload(null,!1),a="success"):a="error",Toast.fire({icon:a,text:e.message})},error:function(e){console.log("Error",e)}}):e.dismiss},function(e){return!1})})}if($("#update-guide-form").length){var W=$("#update-guide-form"),z=W.find("input[name=date]");z.on("change",function(e){$(this).attr("value",$(this).val())}),$("#update-guide-form").on("submit",function(e){e.preventDefault();var a=$(this).attr("action"),t=z.val();$.ajax({type:$(this).attr("method"),url:a,data:{date:t},dataType:"JSON",success:function(e){var a="";a=e.success?"success":"error",Toast.fire({icon:a,text:e.message})},error:function(e){console.log(e)}})})}if($("#waste_warehouse_select").length){let e={placeholder:"Todos",allowClear:!0},a={filter:"warehouse"};InitAjaxSelect2("#waste_warehouse_select",e,"name",a)}if($("#waste_company_select").length){let e={placeholder:"Todos",allowClear:!0},a={filter:"company"};InitAjaxSelect2("#waste_company_select",e,"name",a)}if($("#waste_code_select").length){let e={placeholder:"Todos",allowClear:!0},a={filter:"code"};InitAjaxSelect2("#waste_code_select",e,"code",a)}if($("#waste_wastetype_select").length){let e={placeholder:"Todos",allowClear:!0},a={filter:"waste"};InitAjaxSelect2("#waste_wastetype_select",e,"name",a)}if($("#waste_group_select").length){let e={placeholder:"Todos",allowClear:!0},a={filter:"group"};InitAjaxSelect2("#waste_group_select",e,"name",a)}if($("#waste_group_select_departure").length){let e={placeholder:"Todos",allowClear:!0},a={filter:"group"};InitAjaxSelect2("#waste_group_select_departure",e,"name",a)}if($("#generated-wastes-table-admin").length){var U,H=$("#form-generated-wastes-container"),I=($("#filters-container"),H.find("input[name=from_date]")),K=H.find("input[name=end_date]"),V=$("#waste_warehouse_select"),X=$("#waste_company_select"),Q=$("#waste_code_select"),Z=$("#waste_wastetype_select"),ee=$("#waste_group_select");$("html").on("change",".waste_internment_select",function(){U.ajax.reload();let e=$(this),a=e.attr("name"),t=e.val(),n=H.find(`input[name=${a}]`);n.length&&n.val(t)});$("input#max_date").val();let e=$("input#min_date").val();var ae=$(".datepicker-range-container.input-daterange");ae.datepicker({language:"es",orientation:"bottom auto"});var te=$("#fromDateSelect"),ne=$("#toDateSelect");ae.find("input[name=fromDate]").each(function(){let a=$(this);a.datepicker("setDate",new Date(e)).on("hide",function(e){let a=I.val(),t=e.format(null,"yyyy-mm-dd");(""===a||""!==a&&a!==t)&&U.ajax.reload(),I.val(t),K.val(moment(ne.datepicker("getDate")).format("YYYY-MM-DD"))})}),ae.find("input[name=toDate]").each(function(){let e=$(this);e.datepicker("setDate",new Date).on("hide",function(e){let a=K.val(),t=e.format(null,"yyyy-mm-dd");console.log(a),(""===a||""!==a&&a!==t)&&U.ajax.reload(),K.val(t),I.val(moment(te.datepicker("getDate")).format("YYYY-MM-DD"))})});var oe=$("#generated-wastes-table-admin");o=oe.data("url");U=oe.DataTable({order:[[2,"desc"]],responsive:!0,language:DataTableEs,serverSide:!0,processing:!0,ajax:{url:o,data:function(e){e.from_date=moment(te.datepicker("getDate")).format("YYYY-MM-DD"),e.end_date=moment(ne.datepicker("getDate")).format("YYYY-MM-DD"),e.warehouse=V.val(),e.company=X.val(),e.code=Q.val(),e.wastetype=Z.val(),e.group=ee.val()}},columns:[{data:"id",name:"id"},{data:"guide.code",name:"guide.code",className:"text-nowrap"},{data:"guide.created_at",name:"guide.created_at",className:"text-nowrap"},{data:"guide.warehouse.name",name:"guide.warehouse.name"},{data:"guide.warehouse.lot.name",name:"guide.warehouse.lot.name"},{data:"guide.warehouse.location.name",name:"guide.warehouse.location.name"},{data:"guide.warehouse.activity",name:"guide.warehouse.activity"},{data:"guide.warehouse.project_area.name",name:"guide.warehouse.projectArea.name"},{data:"guide.warehouse.company.name",name:"guide.warehouse.company.name"},{data:"guide.warehouse.code",name:"guide.warehouse.code"},{data:"waste.name",name:"waste.name"},{data:"waste.classes_wastes.symbol",name:"waste.classesWastes.symbol",orderable:!1,searchable:!1},{data:"waste.classes_wastes.group.name",name:"waste.classesWastes.group.name",orderable:!1,searchable:!1},{data:"gestion_type",name:"gestion_type"},{data:"aprox_weight",name:"aprox_weight"},{data:"action",name:"action",className:"action",orderable:!1,searchable:!1}]}),$("#button-save-guide").on("click",function(e){e.preventDefault();var t=$("#createIntermentGuideModal"),n=t.find("#registerGuideForm"),o=$(".selects-inputs-wasteType").length,r=$(this),s=r.find(".loadSpinner"),i=a();0==o&&(i=!1),i?Swal.fire({title:"Confirmar solicitud",icon:"info",showCancelButton:!0,confirmButtonText:"Confirmar",cancelButtonText:"Cancelar",reverseButtons:!0}).then(function(e){!0===e.value?(s.toggleClass("active"),$.ajax({url:n.attr("action"),method:n.attr("method"),data:n.serialize(),dataType:"JSON",success:function(e){e.success?(Toast.fire({icon:"success",text:e.message}),U.ajax.reload(),t.modal("hide")):Toast.fire({icon:"error",text:e.message})},complete:function(){s.toggleClass("active")},error:function(e){console.log(e)}})):e.dismiss},function(e){return!1}):Swal.fire({toast:!0,icon:"warning",title:"Advertencia:",text:"¡Rellena el formulario para continuar!",position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.addEventListener("mouseenter",Swal.stopTimer),e.addEventListener("mouseleave",Swal.resumeTimer)}})});var re=$("#editGuideWasteModal"),se=(W=re.find("#editGuideWasteForm"),W.find("select[name=class_symbol]")),ie=W.find("select[name=waste_type]"),de=W.find("select[name=gestion_type]");se.select2({dropdownParent:"#editGuideWasteForm"}),ie.select2({dropdownParent:"#editGuideWasteForm"}),de.select2({dropdownParent:"#editGuideWasteForm"}),$("html").on("click",".editWaste",function(){let e=$(this),a=e.data("send"),t=e.data("url");W.attr("action",t),se.empty(),ie.empty(),de.empty(),$.ajax({method:"GET",url:a,dataType:"JSON",success:function(e){let a=e.waste,t=a.guide,n=e.classes,o=e.waste_class,r=e.gestion_types;W.find("#code_guide_waste").html(t.code),$.each(t,function(e,a){let t=W.find("[name="+e+"]");t.length&&t.val(a)}),$.each(a,function(e,a){let t=W.find("[name="+e+"]");t.length&&t.val(a)}),$.each(n,function(e,a){se.append('<option value="'+a.id+'">'+a.symbol+"</option>")}),se.val(o.id).trigger("change"),$.each(o.classes_wastes,function(e,a){ie.append(`<option value="${a.id}">${a.name}</option>`)}),ie.val(a.waste.id).trigger("change"),$.each(r,function(e,a){de.append(`<option value="${e}">${a}</option>`)}),de.val(a.gestion_type).trigger("change"),W.find("[name=volum]").val(null==a.packing_guide?"":a.packing_guide.volum),re.modal("show")},error:function(e){console.log(e)}})}),se.on("change",function(){if(re.hasClass("show")){let e=$(this).data("url"),a=se.val();ie.empty(),$.ajax({method:"GET",url:e,data:{id:a,type:"wasteClass"},dataType:"JSON",success:function(e){let a=e.wasteTypes;$.each(a,function(e,a){ie.append(`<option value="${a.id}">${a.name}</option>`)})},error:function(e){console.log(e)}})}}),$("#editGuideWasteForm").on("submit",function(e){e.preventDefault();var a=$(this),t=a.find(".loadSpinner"),n=a.find(".btn-save");SwalConfirm.fire().then(function(e){!0===e.value?(n.attr("disabled","disabled"),t.toggleClass("active"),$.ajax({type:a.attr("method"),url:a.attr("action"),data:a.serialize(),dataType:"JSON",success:function(e){e.success?(Toast.fire({icon:"success",text:e.message}),U.ajax.reload(null,!1),re.modal("hide")):ToastError.fire()},complete:function(e){n.removeAttr("disabled"),t.toggleClass("active")},error:function(e){console.log(e)}})):e.dismiss},function(e){return!1})}),$("html").on("click",".deleteWaste",function(){let e=$(this),a=e.data("url");SwalDelete.fire().then(function(e){!0===e.value?$.ajax({type:"DELETE",url:a,dataType:"JSON",success:function(e){e.success?(Toast.fire({icon:"success",text:e.message}),U.ajax.reload(null,!1)):ToastError.fire()},error:function(e){console.log(e)}}):e.dismiss},function(e){return!1})}),U.on("draw.dt",function(){let e=$("#total_weight_count_internment"),a=e.data("url");$.ajax({url:a,method:"GET",data:{from_date:moment(te.datepicker("getDate")).format("YYYY-MM-DD"),end_date:moment(ne.datepicker("getDate")).format("YYYY-MM-DD"),warehouse:V.val(),company:X.val(),code:Q.val(),wastetype:Z.val(),group:ee.val()},success:function(a){e.val(a.value.toLocaleString("en-US"))},error:function(e){console.log(e)}})})}if($("#guide-pending-table-applicant").length){var le=$("#guide-pending-table-applicant");o=le.data("url"),le.DataTable({order:[[1,"desc"]],responsive:!0,language:DataTableEs,serverSide:!0,processing:!0,ajax:{url:o,data:{table:"pending"}},columns:[{data:"code",name:"code"},{data:"created_at",name:"created_at"},{data:"warehouse.lot.name",name:"warehouse.lot.name",orderable:!1},{data:"warehouse.stage.name",name:"warehouse.stage.name",orderable:!1},{data:"warehouse.location.name",name:"warehouse.location.name",orderable:!1},{data:"warehouse.project_area.name",name:"warehouse.projectArea.name",orderable:!1},{data:"warehouse.company.name",name:"warehouse.company.name",orderable:!1},{data:"warehouse.front.name",name:"warehouse.front.name",orderable:!1},{data:"stat_approved",name:"stat_approved",orderable:!1},{data:"stat_recieved",name:"stat_recieved",orderable:!1},{data:"stat_verified",name:"stat_verified",orderable:!1},{data:"action",name:"action",orderable:!1,searchable:!1},{data:"pdf",name:"pdf",orderable:!1,searchable:!1,className:"text-center not-export-col"}]})}if($("#guide-approved-table-applicant").length){var ce=$("#guide-approved-table-applicant");o=ce.data("url"),ce.DataTable({order:[[1,"desc"]],responsive:!0,language:DataTableEs,serverSide:!0,processing:!0,ajax:{url:o,data:{table:"approved"}},columns:[{data:"code",name:"code"},{data:"created_at",name:"created_at"},{data:"warehouse.lot.name",name:"warehouse.lot.name",orderable:!1},{data:"warehouse.stage.name",name:"warehouse.stage.name",orderable:!1},{data:"warehouse.location.name",name:"warehouse.location.name",orderable:!1},{data:"warehouse.project_area.name",name:"warehouse.projectArea.name",orderable:!1},{data:"warehouse.company.name",name:"warehouse.company.name",orderable:!1},{data:"warehouse.front.name",name:"warehouse.front.name",orderable:!1},{data:"stat_approved",name:"stat_approved",orderable:!1},{data:"stat_recieved",name:"stat_recieved",orderable:!1},{data:"stat_verified",name:"stat_verified",orderable:!1},{data:"action",name:"action",orderable:!1,searchable:!1},{data:"pdf",name:"pdf",orderable:!1,searchable:!1,className:"text-center"}]})}if($("#guide-rejected-table-applicant").length){var me=$("#guide-rejected-table-applicant");o=me.data("url"),me.DataTable({order:[[1,"desc"]],responsive:!0,language:DataTableEs,serverSide:!0,processing:!0,ajax:{url:o,data:{table:"rejected"}},columns:[{data:"code",name:"code"},{data:"created_at",name:"created_at"},{data:"warehouse.lot.name",name:"warehouse.lot.name",orderable:!1},{data:"warehouse.stage.name",name:"warehouse.stage.name",orderable:!1},{data:"warehouse.location.name",name:"warehouse.location.name",orderable:!1},{data:"warehouse.project_area.name",name:"warehouse.projectArea.name",orderable:!1},{data:"warehouse.company.name",name:"warehouse.company.name",orderable:!1},{data:"warehouse.front.name",name:"warehouse.front.name",orderable:!1},{data:"stat_approved",name:"stat_approved",orderable:!1},{data:"stat_recieved",name:"stat_recieved",orderable:!1},{data:"stat_verified",name:"stat_verified",orderable:!1},{data:"action",name:"action",orderable:!1,searchable:!1}]})}if($("#registerGuideForm").length&&($("html").on("click","#btn-register-intguide-modal",function(){let e=$(this),a=e.data("url"),t=$("#createIntermentGuideModal"),n=e.find(".loadSpinner");n.toggleClass("active");let o=t.find("#content-register-intguide");$.ajax({url:a,method:"GET",dataType:"JSON",success:function(e){let a=e.html;o.html(a);let n=$("#guide-warehouse-select");n.select2({dropdownParent:"#registerGuideForm",placeholder:"Selecciona un punto verde"});var r=$("#guide-wasteClass-select");r.select2({dropdownParent:"#registerGuideForm",placeholder:"Selecciona una clase de residuo"});var s=$("#guide-wasteTypes-select");s.select2({dropdownParent:"#registerGuideForm",placeholder:"Selecciona uno o más tipos de residuo",closeOnSelect:!1}),t.modal("show")},complete:function(){n.toggleClass("active")},error:function(e){console.log(e)}})}),$("html").on("change","#guide-warehouse-select",function(){var e=$(this).val(),a=$(this).data("url");$.ajax({type:"GET",data:{id:e,type:"warehouse"},url:a,dataType:"JSON",success:function(e){$("#guide-lot-dis").val(e.lot),$("#guide-location-dis").val(e.location),$("#guide-activity-dis").val(e.activity),$("#guide-proyect-dis").val(e.proyect),$("#guide-company-dis").val(e.company)},error:function(e){console.log(e)}})}),$("html").on("change","#guide-wasteClass-select",function(){var e=$(this).data("url"),a=$(this).val(),t=$("#guide-wasteTypes-select");$.ajax({url:e,data:{id:a,type:"wasteClass"},type:"GET",dataType:"JSON",success:function(e){t.html(""),t.append('<option value=""></option>'),$.each(e.wasteTypes,function(e,a){t.append('<option value="'+a.id+'">'+a.name+"</option>")})},error:function(e){console.log(e)}})}),$("html").on("click","#btn-save-classWaste-guide",function(e){e.preventDefault();var a=$("#guide-wasteTypes-select"),t=a.val(),n=$(this).data("url"),o=$("#table-classTypes-body");0==t.length?Swal.fire({toast:!0,icon:"warning",title:"Advertencia:",text:"¡Selecciona al menos un tipo de residuo para continuar!",position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.addEventListener("mouseenter",Swal.stopTimer),e.addEventListener("mouseleave",Swal.resumeTimer)}}):$.ajax({type:"GET",url:n,data:{values:t,type:"wasteType"},dataType:"JSON",success:function(e){$.each(e.wasteTypes,function(a,t){if(!$("#rowClassType-"+t.id).length){o.prepend('<tr id="rowClassType-'+t.id+'">                                                         <input type="hidden" name="wasteTypesId[]" value="'+t.id+'">                                                         <td>'+t.classes_wastes[0].symbol+"</td>                                                         <td>"+t.name+'</td>                                                         <td>                                                             <input name="aproxWeightType-'+t.id+'" class="form-control col-6 selects-inputs-wasteType select-weight required-input" type="number" min="0" step="0.01" value="">                                                         </td>                                                         <td> <select name="gestionType-'+t.id+'" class="form-control select2 select-packages required-input">                                                            </select>                                                        </td>                                                         <td>                                                             <button class="delete-row-wasteype-guide btn btn-danger">                                                                <i class="fa-solid fa-trash-can"></i>                                                            </button>                                                        </td>                                                     </tr>');var n=$("#rowClassType-"+t.id).find(".select-packages");n.append('<option value=""></option>'),$.each(e.gestionTypes,function(e,a){n.append('<option value="'+e+'">'+a+"</option>")}),n.select2({placeholder:"Selecciona una gestión"})}})},error:function(e){console.log(e)}})}),$("html").on("click",".delete-row-wasteype-guide",function(e){e.preventDefault(),$(this).closest("tr").remove();var a=0;$(".select-weight").each(function(){a+=Number($(this).val())}),$("#info-total-weight").html(a.toFixed(2))}),$("html").on("input",".select-weight",function(){var e=0;$(".select-weight").each(function(){e+=Number($(this).val())}),$("#info-total-weight").html(e.toFixed(2))})),$("#daterange-btn-wastes-applicant").length&&($(".date-range-input").val("Todos los registros"),$(".daterange-cus").daterangepicker({locale:{format:"YYYY-MM-DD"},drops:"down",opens:"right"}),$("#daterange-btn-wastes-applicant").daterangepicker({ranges:{Todo:[moment("1970-01-01"),moment().add(1,"days")],Hoy:[moment(),moment().add(1,"days")],Ayer:[moment().subtract(1,"days"),moment()],"Últimos 7 días":[moment().subtract(6,"days"),moment().add(1,"days")],"Últimos 30 días":[moment().subtract(29,"days"),moment().add(1,"days")],"Este mes":[moment().startOf("month"),moment().endOf("month").add(1,"days")],"Último mes":[moment().subtract(1,"month").startOf("month"),moment().subtract(1,"month").endOf("month").add(1,"days")]},startDate:moment("1970-01-01"),endDate:moment().add(1,"days")},function(e,a){"1970-01-01"==e.format("YYYY-MM-DD")?$(".date-range-input").val("Todos los registros"):$(".date-range-input").val("Del: "+e.format("YYYY-MM-DD")+" hasta el: "+a.format("YYYY-MM-DD")),pe.draw()})),$("#generated-wastes-table-applicant").length)var ue=$("#generated-wastes-table-applicant"),pe=(o=ue.data("url"),ue.DataTable({order:[[3,"desc"]],responsive:!0,language:DataTableEs,ajax:{url:o},columns:[{data:"id",name:"id"},{data:"guide.code",name:"guide.code"},{data:"guide.date_approved",name:"guide.date_approved"},{data:"guide.date_verified",name:"guide.date_verified"},{data:"guide.warehouse.lot.name",name:"guide.warehouse.lot.name"},{data:"guide.warehouse.stage.name",name:"guide.warehouse.stage.name"},{data:"guide.warehouse.location.name",name:"guide.warehouse.location.name"},{data:"guide.warehouse.project_area.name",name:"guide.warehouse.projectArea.name"},{data:"guide.warehouse.company.name",name:"guide.warehouse.company.name"},{data:"guide.warehouse.front.name",name:"guide.warehouse.front.name"},{data:"waste.classes_wastes",name:"waste.classesWastes.symbol",orderable:!1},{data:"waste.name",name:"waste.name",orderable:!1},{data:"package.name",name:"package.name",orderable:!1},{data:"actual_weight",name:"actual_weight",orderable:!1},{data:"package_quantity",name:"package_quantity",orderable:!1},{data:"packing_guide.volum",name:"packingGuide.volum",orderable:!1,searchable:!1},{data:"packing_guide.date_guides_departure",name:"packingGuide.date_guides_departure"},{data:"date_departure",name:"date_departure",orderable:!1,searchable:!1},{data:"disposition.code_green_care",name:"disposition.code_green_care"},{data:"disposition.destination",name:"disposition.destination"},{data:"disposition.plate_init",name:"disposition.plate_init"},{data:"disposition.weigth_init",name:"disposition.weigth_init"},{data:"disposition.date_departure",name:"disposition.date_departure"},{data:"disposition.code_dff",name:"disposition.code_dff"},{data:"disposition.weigth",name:"disposition.weigth"},{data:"disposition.weigth_diff",name:"disposition.weigth_diff"},{data:"disposition.disposition_place",name:"disposition.disposition_place"},{data:"disposition.code_invoice",name:"disposition.code_invoice"},{data:"disposition.code_certification",name:"disposition.code_certification"},{data:"disposition.plate",name:"disposition.plate"},{data:"disposition.managment_report",name:"disposition.managment_report"},{data:"disposition.observations",name:"disposition.observations"},{data:"disposition.date_dff",name:"disposition.date_dff"},{data:"disposition.status",name:"disposition.status"}],columnDefs:[{visible:!1,targets:[4,5,6,7,8,9,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33]}],dom:"Bfrtip",buttons:[{text:'<i class="fa-solid fa-download"></i> &nbsp; Descargar Excel',extend:"excelHtml5",title:function(){var e=$("#daterange-btn-wastes-applicant").data("daterangepicker").startDate.format("YYYY-MM-DD"),a=$("#daterange-btn-wastes-applicant").data("daterangepicker").endDate.format("YYYY-MM-DD"),t=$("#excel-generated-wastes-info").data("name");return"1970-01-01"==e&&(e="El principio"),"RESIDUOS GENERADOS - SOLICITANTE: "+t+" - DESDE: "+e+" - HASTA: "+a},filename:function(){var e=$("#daterange-btn-wastes-applicant").data("daterangepicker").startDate.format("YYYY-MM-DD"),a=$("#daterange-btn-wastes-applicant").data("daterangepicker").endDate.format("YYYY-MM-DD"),t=$("#excel-generated-wastes-info").data("name");return"1970-01-01"==e&&(e="todos"),"residuos-generados_solicitante-"+t+"_"+e+"_"+a+"_"+moment().format("hh-mm-ss")}}],initComplete:function(){$.fn.dataTable.ext.search.push(function(e,a,t){if("generated-wastes-table-applicant"!==e.nTable.id)return!0;var n=moment($("#daterange-btn-wastes-applicant").data("daterangepicker").startDate.format("YYYY-MM-DD")).toDate(),o=moment($("#daterange-btn-wastes-applicant").data("daterangepicker").endDate.format("YYYY-MM-DD")).toDate(),r=moment(a[3]).toDate();return console.log(r),null==n&&null==o||(null==n&&r<=o||(null==o&&r>=n||r<=o&&r>=n))})}}));if($("#guide-pending-table-approvant").length){var ge=$("#guide-pending-table-approvant");o=ge.data("url"),ge.DataTable({language:DataTableEs,responsive:!0,serverSide:!0,processing:!0,ajax:{url:o,data:{table:"pending"}},columns:[{data:"code",name:"code"},{data:"created_at",name:"created_at"},{data:"warehouse.lot.name",name:"warehouse.lot.name",orderable:!1},{data:"warehouse.stage.name",name:"warehouse.stage.name",orderable:!1},{data:"warehouse.location.name",name:"warehouse.location.name",orderable:!1},{data:"warehouse.project_area.name",name:"warehouse.projectArea.name",orderable:!1},{data:"warehouse.company.name",name:"warehouse.company.name",orderable:!1},{data:"warehouse.front.name",name:"warehouse.front.name",orderable:!1},{data:"action",name:"action",orderable:!1,searchable:!1}]})}if($("#register-approved-guide-form").length&&($("#button-save-approved-guide").on("click",function(e){e.preventDefault();var a=$("#register-approved-guide-form");Swal.fire({title:"Confirmar Aprobación",text:"¡Esta acción no se podrá deshacer!",icon:"info",showCancelButton:!0,confirmButtonText:"Confirmar",cancelButtonText:"Cancelar",reverseButtons:!0}).then(e=>{e.isConfirmed&&a.submit()},function(e){return!1})}),$("#button-rejected-guide").on("click",function(e){e.preventDefault();var a=$("#form-reject-guide");Swal.fire({title:"Rechazar solicitud",text:"Luego se podrá deshacer esta acción",icon:"warning",showCancelButton:!0,confirmButtonText:"Rechazar",cancelButtonText:"Atrás",reverseButtons:!0}).then(e=>{e.isConfirmed&&a.submit()},function(e){return!1})})),$("#guide-approved-table-approvant").length){var fe=$("#guide-approved-table-approvant");o=fe.data("url"),fe.DataTable({language:DataTableEs,responsive:!0,serverSide:!0,processing:!0,ajax:{url:o,data:{table:"approved"}},columns:[{data:"code",name:"code"},{data:"created_at",name:"created_at"},{data:"warehouse.lot.name",name:"warehouse.lot.name",orderable:!1},{data:"warehouse.stage.name",name:"warehouse.stage.name",orderable:!1},{data:"warehouse.location.name",name:"warehouse.location.name",orderable:!1},{data:"warehouse.project_area.name",name:"warehouse.projectArea.name",orderable:!1},{data:"warehouse.company.name",name:"warehouse.company.name",orderable:!1},{data:"warehouse.front.name",name:"warehouse.front.name",orderable:!1},{data:"action",name:"action",orderable:!1,searchable:!1}]})}if($("#guide-rejected-table-approvant").length){var he=$("#guide-rejected-table-approvant");o=he.data("url"),he.DataTable({responsive:!0,language:DataTableEs,serverSide:!0,processing:!0,ajax:{url:o,data:{table:"rejected"}},columns:[{data:"code",name:"code"},{data:"created_at",name:"created_at"},{data:"warehouse.lot.name",name:"warehouse.lot.name",orderable:!1},{data:"warehouse.stage.name",name:"warehouse.stage.name",orderable:!1},{data:"warehouse.location.name",name:"warehouse.location.name",orderable:!1},{data:"warehouse.project_area.name",name:"warehouse.projectArea.name",orderable:!1},{data:"warehouse.company.name",name:"warehouse.company.name",orderable:!1},{data:"warehouse.front.name",name:"warehouse.front.name",orderable:!1},{data:"action",name:"action",orderable:!1,searchable:!1}]})}if($("#daterange-btn-wastes-approver").length&&($(".date-range-input").val("Todos los registros"),$(".daterange-cus").daterangepicker({locale:{format:"YYYY-MM-DD"},drops:"down",opens:"right"}),$("#daterange-btn-wastes-approver").daterangepicker({ranges:{Todo:[moment("1970-01-01"),moment().add(1,"days")],Hoy:[moment(),moment().add(1,"days")],Ayer:[moment().subtract(1,"days"),moment()],"Últimos 7 días":[moment().subtract(6,"days"),moment().add(1,"days")],"Últimos 30 días":[moment().subtract(29,"days"),moment().add(1,"days")],"Este mes":[moment().startOf("month"),moment().endOf("month").add(1,"days")],"Último mes":[moment().subtract(1,"month").startOf("month"),moment().subtract(1,"month").endOf("month").add(1,"days")]},startDate:moment("1970-01-01"),endDate:moment().add(1,"days")},function(e,a){"1970-01-01"==e.format("YYYY-MM-DD")?$(".date-range-input").val("Todos los registros"):$(".date-range-input").val("Del: "+e.format("YYYY-MM-DD")+" hasta el: "+a.format("YYYY-MM-DD")),we.draw()})),$("#generated-wastes-table-approver").length)var ve=$("#generated-wastes-table-approver"),we=(o=ve.data("url"),ve.DataTable({order:[[3,"desc"]],responsive:!0,language:DataTableEs,ajax:{url:o},columnDefs:[{visible:!1,targets:[4,5,6,7,8,9,16,17]}],columns:[{data:"id",name:"id"},{data:"guide.code",name:"guide.code"},{data:"guide.date_approved",name:"guide.date_approved"},{data:"guide.date_verified",name:"guide.date_verified"},{data:"guide.warehouse.lot.name",name:"guide.warehouse.lot.name"},{data:"guide.warehouse.stage.name",name:"guide.warehouse.stage.name"},{data:"guide.warehouse.location.name",name:"guide.warehouse.location.name"},{data:"guide.warehouse.project_area.name",name:"guide.warehouse.projectArea.name"},{data:"guide.warehouse.company.name",name:"guide.warehouse.company.name"},{data:"guide.warehouse.front.name",name:"guide.warehouse.front.name"},{data:"waste.classes_wastes",name:"waste.classesWastes.symbol",orderable:!1},{data:"waste.name",name:"waste.name",orderable:!1},{data:"package.name",name:"package.name",orderable:!1},{data:"actual_weight",name:"actual_weight",orderable:!1},{data:"package_quantity",name:"package_quantity",orderable:!1},{data:"packing_guide.volum",name:"packingGuide.volum",orderable:!1,searchable:!1},{data:"packing_guide.date_guides_departure",name:"packingGuide.date_guides_departure"},{data:"date_departure",name:"date_departure",orderable:!1,searchable:!1}],dom:"Bfrtip",buttons:[{text:'<i class="fa-solid fa-download"></i> &nbsp; Descargar Excel',extend:"excelHtml5",title:function(){var e=$("#daterange-btn-wastes-approver").data("daterangepicker").startDate.format("YYYY-MM-DD"),a=$("#daterange-btn-wastes-approver").data("daterangepicker").endDate.format("YYYY-MM-DD"),t=$("#excel-generated-wastes-info").data("name");return"1970-01-01"==e&&(e="El principio"),"RESIDUOS GENERADOS - APROBANTE: "+t+" - DESDE: "+e+" - HASTA: "+a},filename:function(){var e=$("#daterange-btn-wastes-approver").data("daterangepicker").startDate.format("YYYY-MM-DD"),a=$("#daterange-btn-wastes-approver").data("daterangepicker").endDate.format("YYYY-MM-DD"),t=$("#excel-generated-wastes-info").data("name");return"1970-01-01"==e&&(e="todos"),"residuos-generados_aprobante-"+t+"_"+e+"_"+a+"_"+moment().format("hh-mm-ss")}}],initComplete:function(){$.fn.dataTable.ext.search.push(function(e,a,t){if("generated-wastes-table-approver"!==e.nTable.id)return!0;var n=moment($("#daterange-btn-wastes-approver").data("daterangepicker").startDate.format("YYYY-MM-DD")).toDate(),o=moment($("#daterange-btn-wastes-approver").data("daterangepicker").endDate.format("YYYY-MM-DD")).toDate(),r=moment(a[3]).toDate();return console.log(r),null==n&&null==o||(null==n&&r<=o||(null==o&&r>=n||r<=o&&r>=n))})}}));if($("#guide-pending-table-reciever").length){var $e=$("#guide-pending-table-reciever");o=$e.data("url"),$e.DataTable({language:DataTableEs,responsive:!0,serverSide:!0,processing:!0,ajax:{url:o,data:{table:"pending"}},columns:[{data:"code",name:"code"},{data:"created_at",name:"created_at"},{data:"warehouse.lot.name",name:"warehouse.lot.name"},{data:"warehouse.stage.name",name:"warehouse.stage.name"},{data:"warehouse.location.name",name:"warehouse.location.name"},{data:"warehouse.project_area.name",name:"warehouse.projectArea.name"},{data:"warehouse.company.name",name:"warehouse.company.name"},{data:"warehouse.front.name",name:"warehouse.front.name"},{data:"action",name:"action",orderable:!1,searchable:!1}]})}if($("#register-recieved-guide-form").length&&($("body").on("input",".select-actual-weight",function(){var e=0;$(".select-actual-weight").each(function(){e+=Number($(this).val())}),$("#info-actual-total-weight").html(e.toFixed(2))}),$("#button-save-reciever-guide").on("click",function(e){
e.preventDefault();var t=$("#register-recieved-guide-form"),n=a();n?Swal.fire({title:"Confirmar Recepción",text:"¡Esta acción no se podrá deshacer!",icon:"info",showCancelButton:!0,confirmButtonText:"Aprobar",cancelButtonText:"Cancelar",reverseButtons:!0}).then(e=>{e.isConfirmed&&t.submit()},function(e){return!1}):Swal.fire({toast:!0,icon:"warning",title:"Advertencia:",text:"LLena todos los campos para continuar",position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.addEventListener("mouseenter",Swal.stopTimer),e.addEventListener("mouseleave",Swal.resumeTimer)}})}),$("#button-rejected-reciever-guide").on("click",function(e){e.preventDefault();var a=$("#form-reject-reciever-guide");Swal.fire({title:"¿Rechazar guía de internamiento?",text:"Luego se podrá deshacer esta acción",icon:"warning",showCancelButton:!0,confirmButtonText:"Rechazar",cancelButtonText:"cerrar",reverseButtons:!0}).then(e=>{e.isConfirmed&&a.submit()},function(e){return!1})})),$("#guide-recieved-table-reciever").length){var be=$("#guide-recieved-table-reciever");o=be.data("url"),be.DataTable({responsive:!0,language:DataTableEs,serverSide:!0,processing:!0,ajax:{url:o,data:{table:"recieved"}},columns:[{data:"code",name:"code"},{data:"created_at",name:"created_at"},{data:"warehouse.lot.name",name:"warehouse.lot.name"},{data:"warehouse.stage.name",name:"warehouse.stage.name"},{data:"warehouse.location.name",name:"warehouse.location.name"},{data:"warehouse.project_area.name",name:"warehouse.projectArea.name"},{data:"warehouse.company.name",name:"warehouse.company.name"},{data:"warehouse.front.name",name:"warehouse.front.name"},{data:"action",name:"action",orderable:!1,searchable:!1}]})}if($("#guide-rejected-table-reciever").length){var _e=$("#guide-rejected-table-reciever");o=_e.data("url"),_e.DataTable({responsive:!0,language:DataTableEs,serverSide:!0,processing:!0,ajax:{url:o,data:{table:"rejected"}},columns:[{data:"code",name:"code"},{data:"created_at",name:"created_at"},{data:"warehouse.lot.name",name:"warehouse.lot.name"},{data:"warehouse.stage.name",name:"warehouse.stage.name"},{data:"warehouse.location.name",name:"warehouse.location.name"},{data:"warehouse.project_area.name",name:"warehouse.projectArea.name"},{data:"warehouse.company.name",name:"warehouse.company.name"},{data:"warehouse.front.name",name:"warehouse.front.name"},{data:"action",name:"action",orderable:!1,searchable:!1}]})}if($("#daterange-btn-wastes-reciever").length&&($(".date-range-input").val("Todos los registros"),$(".daterange-cus").daterangepicker({locale:{format:"YYYY-MM-DD"},drops:"down",opens:"right"}),$("#daterange-btn-wastes-reciever").daterangepicker({ranges:{Todo:[moment("1970-01-01"),moment().add(1,"days")],Hoy:[moment(),moment().add(1,"days")],Ayer:[moment().subtract(1,"days"),moment()],"Últimos 7 días":[moment().subtract(6,"days"),moment().add(1,"days")],"Últimos 30 días":[moment().subtract(29,"days"),moment().add(1,"days")],"Este mes":[moment().startOf("month"),moment().endOf("month").add(1,"days")],"Último mes":[moment().subtract(1,"month").startOf("month"),moment().subtract(1,"month").endOf("month").add(1,"days")]},startDate:moment("1970-01-01"),endDate:moment().add(1,"days")},function(e,a){"1970-01-01"==e.format("YYYY-MM-DD")?$(".date-range-input").val("Todos los registros"):$(".date-range-input").val("Del: "+e.format("YYYY-MM-DD")+" hasta el: "+a.format("YYYY-MM-DD")),ye.draw()})),$("#generated-wastes-table-reciever").length)var Se=$("#generated-wastes-table-reciever"),ye=(o=Se.data("url"),Se.DataTable({responsive:!0,order:[[3,"desc"]],language:DataTableEs,ajax:{url:o},columns:[{data:"id",name:"id"},{data:"guide.code",name:"guide.code"},{data:"guide.date_approved",name:"guide.date_approved"},{data:"guide.date_verified",name:"guide.date_verified"},{data:"guide.warehouse.lot.name",name:"guide.warehouse.lot.name"},{data:"guide.warehouse.stage.name",name:"guide.warehouse.stage.name"},{data:"guide.warehouse.location.name",name:"guide.warehouse.location.name"},{data:"guide.warehouse.project_area.name",name:"guide.warehouse.projectArea.name"},{data:"guide.warehouse.company.name",name:"guide.warehouse.company.name"},{data:"guide.warehouse.front.name",name:"guide.warehouse.front.name"},{data:"waste.classes_wastes",name:"waste.classesWastes.symbol",orderable:!1},{data:"waste.name",name:"waste.name",orderable:!1},{data:"package.name",name:"package.name",orderable:!1},{data:"actual_weight",name:"actual_weight",orderable:!1},{data:"package_quantity",name:"package_quantity",orderable:!1},{data:"packing_guide.volum",name:"packingGuide.volum",orderable:!1,searchable:!1},{data:"packing_guide.date_guides_departure",name:"packingGuide.date_guides_departure"},{data:"date_departure",name:"date_departure",orderable:!1,searchable:!1}],columnDefs:[{visible:!1,targets:[4,5,6,7,8,9,16,17]}],dom:"Bfrtip",buttons:[{text:'<i class="fa-solid fa-download"></i> &nbsp; Descargar Excel',extend:"excelHtml5",title:function(){var e=$("#daterange-btn-wastes-reciever").data("daterangepicker").startDate.format("YYYY-MM-DD"),a=$("#daterange-btn-wastes-reciever").data("daterangepicker").endDate.format("YYYY-MM-DD"),t=$("#excel-generated-wastes-info").data("name");return"1970-01-01"==e&&(e="El principio"),"RESIDUOS GENERADOS - RECEPTOR: "+t+" - DESDE: "+e+" - HASTA: "+a},filename:function(){var e=$("#daterange-btn-wastes-reciever").data("daterangepicker").startDate.format("YYYY-MM-DD"),a=$("#daterange-btn-wastes-reciever").data("daterangepicker").endDate.format("YYYY-MM-DD"),t=$("#excel-generated-wastes-info").data("name");return"1970-01-01"==e&&(e="todos"),"residuos-generados_receptor-"+t+"_"+e+"_"+a+"_"+moment().format("hh-mm-ss")}}],initComplete:function(){$.fn.dataTable.ext.search.push(function(e,a,t){if("generated-wastes-table-reciever"!==e.nTable.id)return!0;var n=moment($("#daterange-btn-wastes-reciever").data("daterangepicker").startDate.format("YYYY-MM-DD")).toDate(),o=moment($("#daterange-btn-wastes-reciever").data("daterangepicker").endDate.format("YYYY-MM-DD")).toDate(),r=moment(a[3]).toDate();return null==n&&null==o||(null==n&&r<=o||(null==o&&r>=n||r<=o&&r>=n))})}}));if($("#daterange-btn-wastes-verificator").length&&($(".date-range-input").val("Todos los registros"),$(".daterange-cus").daterangepicker({locale:{format:"YYYY-MM-DD"},drops:"down",opens:"right"}),$("#daterange-btn-wastes-verificator").daterangepicker({ranges:{Todo:[moment("1970-01-01"),moment().add(1,"days")],Hoy:[moment(),moment().add(1,"days")],Ayer:[moment().subtract(1,"days"),moment()],"Últimos 7 días":[moment().subtract(6,"days"),moment().add(1,"days")],"Últimos 30 días":[moment().subtract(29,"days"),moment().add(1,"days")],"Este mes":[moment().startOf("month"),moment().endOf("month").add(1,"days")],"Último mes":[moment().subtract(1,"month").startOf("month"),moment().subtract(1,"month").endOf("month").add(1,"days")]},startDate:moment("1970-01-01"),endDate:moment().add(1,"days")},function(e,a){"1970-01-01"==e.format("YYYY-MM-DD")?$(".date-range-input").val("Todos los registros"):$(".date-range-input").val("Del: "+e.format("YYYY-MM-DD")+" hasta el: "+a.format("YYYY-MM-DD")),Ee.draw()})),$("#guide-pending-table-verificator").length){var De=$("#guide-pending-table-verificator");o=De.data("url"),De.DataTable({responsive:!0,language:DataTableEs,serverSide:!0,processing:!0,ajax:{url:o,data:{table:"pending"}},columns:[{data:"code",name:"code"},{data:"created_at",name:"created_at"},{data:"warehouse.lot.name",name:"warehouse.lot.name"},{data:"warehouse.stage.name",name:"warehouse.stage.name"},{data:"warehouse.location.name",name:"warehouse.location.name"},{data:"warehouse.project_area.name",name:"warehouse.projectArea.name"},{data:"warehouse.company.name",name:"warehouse.company.name"},{data:"warehouse.front.name",name:"warehouse.front.name"},{data:"action",name:"action",orderable:!1,searchable:!1},{data:"pdf",name:"pdf",orderable:!1,searchable:!1,className:"text-center"}]})}if($("#register-verified-guide-form").length&&($("#button-save-verified-guide").on("click",function(e){e.preventDefault();var a=$("#register-verified-guide-form");Swal.fire({title:"¿Verificar Guía de Internamiento?",text:"Esta acción no se podrá deshacer",icon:"info",showCancelButton:!0,confirmButtonText:"Verificar",cancelButtonText:"Cancelar",reverseButtons:!0}).then(e=>{e.isConfirmed&&a.submit()},function(e){return!1})}),$("#button-rejected-verified-guide").on("click",function(e){e.preventDefault();var a=$("#form-reject-verified-guide");Swal.fire({title:"¿Rechazar guía de internamiento?",text:"Luego se podrá deshacer esta acción.",icon:"warning",showCancelButton:!0,confirmButtonText:"Rechazar",cancelButtonText:"cerrar",reverseButtons:!0}).then(e=>{e.isConfirmed&&a.submit()},function(e){return!1})})),$("#guide-verified-table-verificator").length){var xe=$("#guide-verified-table-verificator");o=xe.data("url"),xe.DataTable({responsive:!0,language:DataTableEs,serverSide:!0,processing:!0,ajax:{url:o,data:{table:"verified"}},columns:[{data:"code",name:"code"},{data:"created_at",name:"created_at"},{data:"warehouse.lot.name",name:"warehouse.lot.name"},{data:"warehouse.stage.name",name:"warehouse.stage.name"},{data:"warehouse.location.name",name:"warehouse.location.name"},{data:"warehouse.project_area.name",name:"warehouse.projectArea.name"},{data:"warehouse.company.name",name:"warehouse.company.name"},{data:"warehouse.front.name",name:"warehouse.front.name"},{data:"action",name:"action",orderable:!1,searchable:!1},{data:"pdf",name:"pdf",orderable:!1,searchable:!1,className:"text-center"}]})}if($("#guide-rejected-table-verificator").length){var Te=$("#guide-rejected-table-verificator");o=Te.data("url"),Te.DataTable({responsive:!0,language:DataTableEs,serverSide:!0,processing:!0,ajax:{url:o,data:{table:"rejected"}},columns:[{data:"code",name:"code"},{data:"created_at",name:"created_at"},{data:"warehouse.lot.name",name:"warehouse.lot.name"},{data:"warehouse.stage.name",name:"warehouse.stage.name"},{data:"warehouse.location.name",name:"warehouse.location.name"},{data:"warehouse.project_area.name",name:"warehouse.projectArea.name"},{data:"warehouse.company.name",name:"warehouse.company.name"},{data:"warehouse.front.name",name:"warehouse.front.name"},{data:"action",name:"action",orderable:!1,searchable:!1}]})}if($("#generated-wastes-table-verificator").length){var Ee,Ye=$("#form-generated-wastes-verificator-container"),Ce=(I=Ye.find("input[name=from_date]"),K=Ye.find("input[name=end_date]"),$("#date-range-input-wastes-verificator")),je=$("#daterange-btn-wastes-verificator");Ce.length&&(Ce.val("Todos los registros"),je.daterangepicker(dateRangeConfig,function(e,a){var t=e.format("YYYY-MM-DD")==a.format("YYYY-MM-DD");t?(I.each(function(){$(this).val("")}),K.each(function(){$(this).val("")}),Ce.val("Todos los registros")):(I.each(function(){$(this).val(e.format("YYYY-MM-DD"))}),K.each(function(){$(this).val(a.format("YYYY-MM-DD"))}),Ce.val("Del: "+e.format("YYYY-MM-DD")+" hasta el: "+a.format("YYYY-MM-DD"))),Ee.ajax.reload()}));var ke=$("#generated-wastes-table-verificator");o=ke.data("url");Ee=ke.DataTable({responsive:!0,order:[[3,"desc"]],language:DataTableEs,serverSide:!0,processing:!0,ajax:{url:o,data:function(e){var a=$("#daterange-btn-wastes-verificator").data("daterangepicker").startDate.format("YYYY-MM-DD"),t=$("#daterange-btn-wastes-verificator").data("daterangepicker").endDate.format("YYYY-MM-DD"),n=a==t;e.from_date=n?null:a,e.end_date=n?null:t}},columns:[{data:"id",name:"id"},{data:"guide.code",name:"guide.code"},{data:"guide.date_approved",name:"guide.date_approved"},{data:"guide.date_verified",name:"guide.date_verified"},{data:"waste.classes_wastes",name:"waste.classesWastes.symbol",orderable:!1},{data:"waste.name",name:"waste.name"},{data:"package.name",name:"package.name"},{data:"actual_weight",name:"actual_weight"},{data:"package_quantity",name:"package_quantity"},{data:"packing_guide.volum",name:"packingGuide.volum"}]})}if($("#undoRejected-guide-form").length&&$("#button-undoReject-guide").on("click",function(e){e.preventDefault();var a=$("#undoRejected-guide-form");Swal.fire({title:"Confirmar",text:"¿Deshacer la acción?",icon:"info",showCancelButton:!0,confirmButtonText:"Confirmar",cancelButtonText:"Cancelar",reverseButtons:!0}).then(e=>{e.isConfirmed&&a.submit()},function(e){return!1})}),$("html").on("click",".btn-show-internmentGuide",function(e){e.preventDefault();var a=$(this),t=a.data("url"),n=$("#showInternmentGuideDetailModal"),o=n.find(".modal-body");o.empty(),$.ajax({type:"GET",url:t,dataType:"JSON",success:function(e){o.html(e.html),n.modal("show")},error:function(e){console.log(e)}})}),$("#interment-wastes-table-manager").length){var Me,Be=$("#form-internment-wastes-report"),Oe=Be.find("input[name=from_date]"),Le=Be.find("input[name=end_date]"),Pe=Be.find("input[name=status]");let a=$("#stock-datepicker.datepicker-range-container.input-daterange"),t=$("input#max_date_stock").val(),n=$("input#min_date_stock").val();a.datepicker({language:"es",orientation:"bottom auto"});var Ne=$("#fromDateSelectStock"),Fe=$("#toDateSelectStock");a.find("input[name=fromDate]").each(function(){let e=$(this);e.datepicker("setDate",new Date(n)).on("hide",function(e){let a=Oe.val(),t=e.format(null,"yyyy-mm-dd");(""===a||""!==a&&a!==t)&&Me.ajax.reload(),Oe.val(t),Le.val(moment(Fe.datepicker("getDate")).format("YYYY-MM-DD"))})}),a.find("input[name=toDate]").each(function(){let e=$(this);e.datepicker("setDate",new Date(t)).on("hide",function(e){let a=Le.val(),t=e.format(null,"yyyy-mm-dd");(""===a||""!==a&&a!==t)&&Me.ajax.reload(),Le.val(t),Oe.val(moment(Ne.datepicker("getDate")).format("YYYY-MM-DD"))})});let r=$("#waste_warehouse_select"),s=$("#waste_company_select"),i=$("#waste_code_select"),d=$("#waste_group_select");$("html").on("change",".waste_internment_select",function(){Me.ajax.reload();let e=$(this),a=e.attr("name"),t=e.val(),n=Be.find(`input[name=${a}]`);n.length&&n.val(t)});var Re=$("#waste_stock_class_select");Re.select2({placeholder:"Todo",allowClear:!0});var Ae=$("#waste_stock_type_select");Ae.select2({placeholder:"Todo",allowClear:!0}),$("input[name=filter-wastespg]").on("change",function(){Pe.val($(this).val()),Me.ajax.reload()}),$("input[name=filter-residualpg]").on("change",function(){Me.ajax.reload()}),$("input[name=filter-selected-stock]").on("change",function(){Me.ajax.reload()}),$("select[name=company_select]").on("change",function(){Me.ajax.reload()}),$("select[name=waste_class_select]").on("change",function(){Me.ajax.reload();let e=$(this),a=e.data("url"),t=e.val();Ae.empty(),Ae.append("<option></option>"),""==t?Ae.closest(".container-select").addClass("select-disabled"):(Ae.closest(".container-select").addClass("select-disabled"),$.ajax({url:a,method:"GET",data:{value:t},dataType:"JSON",success:function(e){let a=e.wastes_types;$.each(a,function(e,a){Ae.append('<option value="'+a.id+'">'+a.name+"</option>")}),Ae.closest(".container-select").removeClass("select-disabled")},error:function(e){console.log(e)}})),Ae.select2({placeholder:"Todo",allowClear:!0})}),$("select[name=waste_type_select]").on("change",function(){Me.ajax.reload()});var Ge,Je=$("#interment-wastes-table-manager");o=Je.data("url");function qe({table:e}){let a=e.select.cumulative().rows;var t=$("#btn-register-packing-guide-container");let n=t.data("send");$.ajax({url:n,method:"POST",data:{selected:a},dataType:"JSON",success:function(e){t.html(e.html_button)},error:function(e){console.log(e)}})}Me=Je.DataTable({responsive:!0,order:[[3,"desc"]],language:DataTableEs,serverSide:!0,processing:!0,ajax:{url:o,data:function(e){e.from_date=moment(Ne.datepicker("getDate")).format("YYYY-MM-DD"),e.end_date=moment(Fe.datepicker("getDate")).format("YYYY-MM-DD"),e.table="intGuide",e.status=$("input[name=filter-wastespg]:checked").val(),e.selected=$("input[name=filter-selected-stock]:checked").val(),e.warehouse=r.val(),e.company=s.val(),e.code=i.val(),e.group=d.val(),e.class=$("select[name=waste_class_select]").val(),e.type=$("select[name=waste_type_select]").val()}},columns:[{data:null,render:DataTable.render.select(),orderable:!1,className:"not-export-col"},{data:"id",name:"id",orderable:!1,searchable:!1},{data:"guide.id",name:"guide.id"},{data:"guide.code",name:"guide.code",className:"text-nowrap"},{data:"guide.created_at",name:"guide.created_at",className:"text-nowrap"},{data:"guide.warehouse.name",name:"guide.warehouse.name"},{data:"guide.warehouse.company.name",name:"guide.warehouse.company.name"},{data:"guide.warehouse.code",name:"guide.warehouse.code"},{data:"waste.name",name:"waste.name"},{data:"waste.classes_wastes.symbol",name:"waste.classes_wastes.symbol",orderable:!1,searchable:!1},{data:"waste.classes_wastes.group.name",name:"waste.classes_wastes.group.name",orderable:!1,searchable:!1},{data:"gestion_type",name:"gestion_type"},{data:"aprox_weight",name:"aprox_weight"},{data:"stat_stock_bool",name:"stat_stock_bool"},{data:"stat_stock",name:"stat_stock"},{data:"action",name:"action",className:"action"}],columnDefs:[{visible:!1,targets:[1,13]}],rowCallback:function(e,a){1===a.stat_stock_bool&&$(e).addClass("unselectable")},rowId:"id",stateSave:!0,select:{style:"multi+shift",selector:"td:first-child",selectable:function(e){return 1!==e.stat_stock_bool}},layout:{topStart:{buttons:["pageLength"]}}}),Me.on("select",function(e,a,t,n){qe({table:Me})}),Me.on("deselect",function(e,a,t,n){qe({table:Me})}),Me.on("draw.dt",function(){let e=$("#total_weight_count_stock"),a=e.data("url");$.ajax({url:a,method:"GET",data:{table:"intGuide",from_date:moment(Ne.datepicker("getDate")).format("YYYY-MM-DD"),end_date:moment(Fe.datepicker("getDate")).format("YYYY-MM-DD"),status:$("input[name=filter-wastespg]:checked").val(),selected:$("input[name=filter-selected-stock]:checked").val(),warehouse:r.val(),company:s.val(),code:i.val(),group:d.val(),class:$("select[name=waste_class_select]").val(),type:$("select[name=waste_type_select]").val()},success:function(a){e.val(a.value.toLocaleString("en-US"))},error:function(e){console.log(e)}})});var We=$("#form-departures-wastes-report"),ze=We.find("input[name=from_date]"),Ue=We.find("input[name=end_date]"),He=We.find("input[name=status]");let l=$("#departure-datepicker.datepicker-range-container.input-daterange"),c=($("input#max_date_depart").val(),$("input#min_date_depart").val());l.datepicker({language:"es",orientation:"bottom auto"});var Ie=$("#fromDateSelectDeparture"),Ke=$("#toDateSelectDeparture");l.find("input[name=fromDate]").each(function(){let e=$(this);e.datepicker("setDate",new Date(c)).on("hide",function(e){let a=ze.val(),t=e.format(null,"yyyy-mm-dd");(""===a||""!==a&&a!==t)&&Ge.ajax.reload(),ze.val(t),Ue.val(moment(Ke.datepicker("getDate")).format("YYYY-MM-DD"))})}),l.find("input[name=toDate]").each(function(){let e=$(this);e.datepicker("setDate",new Date).on("hide",function(e){let a=Ue.val(),t=e.format(null,"yyyy-mm-dd");(""===a||""!==a&&a!==t)&&Ge.ajax.reload(),Ue.val(t),Ue.val(moment(Ie.datepicker("getDate")).format("YYYY-MM-DD"))})});let m=$("#waste_group_select_departure");$("html").on("change",".waste_departure_select",function(){Ge.ajax.reload();let e=$(this),a=e.attr("name"),t=e.val(),n=We.find(`input[name=${a}]`);n.length&&n.val(t)});var Ve=$("#waste_departure_class_select");Ve.select2({placeholder:"Todo",allowClear:!0});var Xe=$("#waste_departure_type_select");Xe.select2({placeholder:"Todo",allowClear:!0}),$("input[name=filter-wastes-departure]").on("change",function(){He.val($(this).val()),Ge.ajax.reload()}),$("select[name=waste_class_select_departure]").on("change",function(){Ge.ajax.reload();let e=$(this),a=e.data("url"),t=e.val();Xe.empty(),Xe.append("<option></option>"),""==t?Xe.closest(".container-select").addClass("select-disabled"):(Xe.closest(".container-select").addClass("select-disabled"),$.ajax({url:a,method:"GET",data:{value:t},dataType:"JSON",success:function(e){let a=e.wastes_types;$.each(a,function(e,a){Xe.append('<option value="'+a.id+'">'+a.name+"</option>")}),Xe.closest(".container-select").removeClass("select-disabled")},error:function(e){console.log(e)}})),Xe.select2({placeholder:"Todo",allowClear:!0})}),$("select[name=waste_type_select_departure]").on("change",function(){Ge.ajax.reload()});var Qe=$("#packing-guides-table-manager"),Ze=Qe.data("url");function ea({table:e}){let a=e.select.cumulative().rows;var t=$("#btn-update-departure-container");let n=t.data("send");$.ajax({url:n,method:"POST",data:{selected:a},dataType:"JSON",success:function(e){t.html(e.html_button)},error:function(e){console.log(e)}})}Ge=Qe.DataTable({responsive:!0,language:DataTableEs,order:[[11,"desc"]],serverSide:!0,processing:!0,ajax:{url:Ze,data:function(e){e.from_date=moment(Ie.datepicker("getDate")).format("YYYY-MM-DD"),e.end_date=moment(Ke.datepicker("getDate")).format("YYYY-MM-DD"),e.table="packing",e.status=$("input[name=filter-wastes-departure]:checked").val(),e.group=m.val(),e.class=$("select[name=waste_class_select_departure]").val(),e.type=$("select[name=waste_type_select_departure]").val()}},columns:[{data:null,render:DataTable.render.select(),orderable:!1,className:"not-export-col"},{data:"id",name:"id",orderable:!1,searchable:!1},{data:"first_waste.guide.id",name:"firstWaste.guide.id"},{data:"cod_guide",name:"cod_guide"},{data:"first_waste.waste.classes_wastes.group.name",name:"first_waste.waste.classes_wastes.group.name",orderable:!1,searchable:!1},{data:"first_waste.waste.name",name:"firstWaste.waste.name"},{data:"wastes_sum_aprox_weight",name:"wastes_sum_aprox_weight"},{data:"volum",name:"volum"},{data:"inter_management.name",name:"interManagement.name"},{data:"status_bool",name:"status_bool"},{data:"status",name:"status"},{data:"date_guides_departure",name:"date_guides_departure"},{data:"year_month",name:"year_month",orderable:!1,searchable:!1},{data:"comment",name:"comment"},{data:"action",name:"action",orderable:!1,searchable:!1,className:"action"}],columnDefs:[{visible:!1,targets:[1,9]}],rowCallback:function(e,a){1===a.status_bool&&$(e).addClass("unselectable")},rowId:"id",stateSave:!0,select:{style:"multi+shift",selector:"td:first-child",selectable:function(e){return 1!==e.status_bool}},layout:{topStart:{buttons:["pageLength"]}}}),Ge.on("select",function(){ea({table:Ge})}),Ge.on("deselect",function(){ea({table:Ge})});var aa=$("#transport-type-select");aa.select2({dropdownParent:$("#updateDeparturePgModal"),placeholder:"Selecciona un transporte"});var ta=$("#destination-select");ta.select2({dropdownParent:$("#updateDeparturePgModal"),placeholder:"Selecciona un destino"});var na=$("#management-type-select");na.select2({dropdownParent:$("#RegisterPackingGuideModal"),placeholder:"Selecciona una opción"}),$("html").on("click","#btn-register-pg-modal",function(){var e=$(this),a=$("#RegisterPackingGuideModal"),t=e.find(".loadSpinner"),n=$("#btn-register-packing-guide-container").data("url"),o=$("#t-body-guides-pg-manager"),r=a.find("#total-weight-pg-manager"),s=a.find("#total-packages-pg-manager");t.toggleClass("active"),o.html(""),r.html(""),s.html(""),$.ajax({type:"GET",url:n,data:{table:"packingGuide"},dataType:"JSON",success:function(e){o.html(e.table),r.html(e.weight),t.toggleClass("active"),a.modal("show")},error:function(e){console.log(e)}})}),$("#register-pg-manager-form").on("submit",function(e){e.preventDefault();var a=$(this),t=a.find(".loadSpinner"),n=a.attr("action"),o=$("#RegisterPackingGuideModal"),r=$("#btn-register-packing-guide-container");Swal.fire({title:"Confirmar",text:"¡Esta acción no se podrá deshacer!",icon:"info",showCancelButton:!0,confirmButtonText:"Registrar",cancelButtonText:"Cancelar",reverseButtons:!0}).then(e=>{e.isConfirmed&&(t.toggleClass("active"),$.ajax({method:a.attr("method"),url:n,data:a.serialize(),dataType:"JSON",success:function(e){Swal.fire({toast:!0,icon:"success",text:"¡Carga realizada!",position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.addEventListener("mouseenter",Swal.stopTimer),e.addEventListener("mouseleave",Swal.resumeTimer)}}),r.html(e.html_button),Me.ajax.reload(),Ge.ajax.reload(),t.toggleClass("active"),o.modal("hide"),o.find("input[name=code]").val(""),o.find("input[name=volume]").val("")},error:function(e){console.log(e)}}))},function(e){return!1})});re=$("#editGuideWasteModal"),W=re.find("#editGuideWasteForm"),se=W.find("select[name=class_symbol]"),ie=W.find("select[name=waste_type]"),de=W.find("select[name=gestion_type]");if(se.select2({dropdownParent:"#editGuideWasteForm"}),ie.select2({dropdownParent:"#editGuideWasteForm"}),de.select2({dropdownParent:"#editGuideWasteForm"}),$("html").on("click",".editWaste",function(){let e=$(this),a=e.data("send"),t=e.data("url");W.attr("action",t),se.empty(),ie.empty(),de.empty(),$.ajax({method:"GET",url:a,dataType:"JSON",success:function(e){let a=e.waste,t=a.guide,n=e.classes,o=e.waste_class,r=e.gestion_types;W.find("#code_guide_waste").html(t.code),$.each(t,function(e,a){let t=W.find("[name="+e+"]");t.length&&t.val(a)}),$.each(a,function(e,a){let t=W.find("[name="+e+"]");t.length&&t.val(a)}),$.each(n,function(e,a){se.append('<option value="'+a.id+'">'+a.symbol+"</option>")}),se.val(o.id).trigger("change"),$.each(o.classes_wastes,function(e,a){ie.append(`<option value="${a.id}">${a.name}</option>`)}),ie.val(a.waste.id).trigger("change"),$.each(r,function(e,a){de.append(`<option value="${e}">${a}</option>`)}),de.val(a.gestion_type).trigger("change"),W.find("[name=volum]").val(null==a.packing_guide?"":a.packing_guide.volum),re.modal("show")},error:function(e){console.log(e)}})}),se.on("change",function(){if(re.hasClass("show")){let e=$(this).data("url"),a=se.val();ie.empty(),$.ajax({method:"GET",url:e,data:{id:a,type:"wasteClass"},dataType:"JSON",success:function(e){let a=e.wasteTypes;$.each(a,function(e,a){ie.append(`<option value="${a.id}">${a.name}</option>`)})},error:function(e){console.log(e)}})}}),$("#editGuideWasteForm").on("submit",function(e){e.preventDefault();var a=$(this),t=a.find(".loadSpinner"),n=a.find(".btn-save");SwalConfirm.fire().then(function(e){!0===e.value?(n.attr("disabled","disabled"),t.toggleClass("active"),$.ajax({type:a.attr("method"),url:a.attr("action"),data:a.serialize(),dataType:"JSON",success:function(e){e.success?(Toast.fire({icon:"success",text:e.message}),Me.ajax.reload(null,!1),re.modal("hide")):ToastError.fire()},complete:function(e){n.removeAttr("disabled"),t.toggleClass("active")},error:function(e){console.log(e)}})):e.dismiss},function(e){return!1})}),$("html").on("click",".deleteWaste",function(){let e=$(this),a=e.data("url");SwalDelete.fire().then(function(e){!0===e.value?$.ajax({type:"DELETE",url:a,dataType:"JSON",success:function(e){e.success?(Toast.fire({icon:"success",text:e.message}),Me.ajax.reload(null,!1)):ToastError.fire()},error:function(e){console.log(e)}}):e.dismiss},function(e){return!1})}),$("html").on("click",".btn-show-stock-part-modal",function(){var e=$("#RegisterStockPartitionModal"),a=$(this).data("get"),t=e.find("#store-partitions-stock-form"),n=(t.find("span.btn-add-partitions"),$(this).data("url")),o=t.find("input[name=partitions_number]");t.trigger("reset"),o.val(1);var r=t.find(".table-stock-partition-container"),s=t.find(".stock-partitions-container"),i=t.find(".sale-stock-partitions-container"),d=t.find(".alert-stock-partitions-container");r.empty(),s.empty(),i.empty(),d.empty(),$.ajax({type:"GET",url:a,dataType:"JSON",success:function(a){t.attr("action",n),r.html(a.html),e.modal("show")},error:function(e){console.log(e)}})}),$("#store-partitions-stock-form").length){function oa(e){return'<div class="form-row row-general-partition">                            <div class="form-group col-lg-5 col-md-7 col-10 row-group-partition">                                <div class="text-nowrap font-weight-bold">                                    Partición                                    <span class="font-weight-bold index-row-partition">                                        '+(e+1)+'                                    </span>                                    :                                </div>                                <input type="number" class="form-control text-right no-arrows required-input" name="partitions_qtty[]" min="0" step="0.1">                                <div class="font-weight-bold">                                    Kg.                                </div>                            </div>                            <div class="form-group col-lg-1 col-2">                                <span class="form-control btn btn-danger btn-remove-partition">                                    <i class="fa-solid fa-trash-can"></i>                                </span>                            </div>                        </div>'}function ra(e){return'<div class="form-row d-flex">                            <div class="form-group col-lg-5 col-md-7 col-10 text-right">                                <div class="text-nowrap font-weight-bold">                                    Saldo:                                    <span class="stock-sale-qtty">                                        '+e+"                                    </span>                                    <span>                                        Kg.                                    </span>                                </div>                            </div>                        </div>"}function sa(){return'<span class="badge badge-pill badge-warning">                            <i class="fa-solid fa-triangle-exclamation me-2"></i>                            La cantidad ingresada superó el peso total del residuo.                        </span>'}var ia=$("#store-partitions-stock-form"),da=ia.find("input[name=partitions_number]"),la=ia.find("span.btn-add-partitions");da.on("keypress",function(e){var a=e.which?e.which:e.keyCode;a<48||a>57?e.preventDefault():(la.removeClass("disabled"),la.addClass("btn-valid-load-partitions"))}),da.on("input",function(e){(""===$(this).val()||$(this).val()<=0)&&(la.addClass("disabled"),la.removeClass("btn-valid-load-partitions"))}),da.on("key blur",function(){var e=$(this).val().replace(/[^0-9]/g,"");$(this).val(e),""===$(this).val()||$(this).val()<=0?(la.addClass("disabled"),la.removeClass("btn-valid-load-partitions")):(la.removeClass("disabled"),la.addClass("btn-valid-load-partitions"))});ia.find(".stock-partitions-container");$("html").on("click",".btn-valid-load-partitions",function(){var e=ia.find("input[name=partitions_number]"),a=ia.find(".stock-partitions-container"),t=a.find(".row-general-partition").length;if(e.val())for(var n=e.val(),o=t;o<n;o++)a.append(oa(o))}),$("html").on("click",".btn-remove-partition",function(){var e=$(this).closest(".row-general-partition"),a=e.closest(".stock-partitions-container"),t=ia.find(".sale-stock-partitions-container"),n=ia.find(".alert-stock-partitions-container"),o=+$("#total-weight-waste-partition").text();e.remove();var r=0;$.each(a.find(".row-general-partition"),function(e,a){$(this).find(".index-row-partition").html(e+1),r+=+$(this).find('input[name="partitions_qtty[]"]').val()}),o-=r,o<0?(t.html(ra(0)),n.html(sa())):(t.html(ra(+o.toFixed(2))),n.empty())}),$("html").on("input",'input[name="partitions_qtty[]"]',function(){var e=$(this).closest(".stock-partitions-container"),a=$("#store-partitions-stock-form").find(".btn-save"),t=ia.find(".sale-stock-partitions-container"),n=ia.find(".alert-stock-partitions-container"),o=+$("#total-weight-waste-partition").text(),r=0;$.each(e.find(".row-general-partition"),function(e,a){r+=+(+$(this).find('input[name="partitions_qtty[]"]').val()).toFixed(2)}),o-=r,o<0?(t.html(ra(0)),n.html(sa()),a.addClass("disabled")):(t.html(ra(+o.toFixed(2))),n.empty(),a.removeClass("disabled"))}),ia.on("submit",function(a){a.preventDefault();var t=$("#RegisterStockPartitionModal"),n=$(this),o=n.find(".required-input").length,r=n.find(".btn-save"),s=r.find(".loadSpinner"),i=e(n);0==o&&(i=!1),i&&!r.hasClass("disabled")?SwalConfirm.fire().then(function(e){!0===e.value?(r.addClass("disabled"),
s.toggleClass("active"),$.ajax({type:n.attr("method"),url:n.attr("action"),data:n.serialize(),dataType:"JSON",success:function(e){e.success?(Toast.fire({icon:"success",text:e.message}),Me.ajax.reload(null,!1),Ge.ajax.reload(null,!1),t.modal("hide")):ToastError.fire()},complete:function(e){r.removeClass("disabled"),s.toggleClass("active")},error:function(e){console.log(e)}})):e.dismiss},function(e){return!1}):Swal.fire({toast:!0,icon:"warning",title:"Advertencia:",text:"¡Rellena el formulario para continuar!",position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.addEventListener("mouseenter",Swal.stopTimer),e.addEventListener("mouseleave",Swal.resumeTimer)}})})}$("html").on("click",".btn-show-packingGuide",function(e){e.preventDefault();var a=$(this),t=a.data("url"),n=$("#showPackingGuideDetailModal"),o=$("#t-body-show-packing-guide-manager"),r=$("#t-body-int-guides-manager");o.html(""),r.html(""),$.ajax({type:"GET",url:t,data:{table:"packingGuide"},dataType:"JSON",success:function(e){o.html(e.html_pg),r.html(e.html_wastes),n.modal("show")},error:function(e){console.log(e)}})}),$("html").on("click","#btn-update-departure-modal",function(){var e=$(this),a=$("#updateDeparturePgModal"),t=e.find(".loadSpinner"),n=$("#btn-update-departure-container").data("url"),o=$("#t-body-guides-departure-manager");t.toggleClass("active"),o.html(""),$.ajax({type:"GET",url:n,data:{table:"departure"},dataType:"JSON",success:function(e){o.html(e.html),a.modal("show")},complete:function(e){t.toggleClass("active")},error:function(e){console.log(e)}})}),$("#updateDeparture-pg-manager-form").on("submit",function(e){e.preventDefault();var a=$(this),t=a.attr("action"),n=$("#updateDeparturePgModal"),o=n.find(".loadSpinner"),r=$("#btn-update-departure-container");Swal.fire({title:"Confirmar",text:"¡Esta acción no se podrá deshacer!",icon:"info",showCancelButton:!0,confirmButtonText:"Registrar",cancelButtonText:"Cancelar",reverseButtons:!0}).then(e=>{e.isConfirmed&&(o.toggleClass("active"),$.ajax({method:a.attr("method"),url:t,data:a.serialize(),dataType:"JSON",success:function(e){Swal.fire({toast:!0,icon:"success",text:"¡Salida efectuada!",position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.addEventListener("mouseenter",Swal.stopTimer),e.addEventListener("mouseleave",Swal.resumeTimer)}}),r.html(e.html_button),Me.ajax.reload(null,!1),Ge.ajax.reload(null,!1),o.toggleClass("active"),n.modal("hide"),n.find("select[name=transport-type]").val("").trigger("change"),n.find("select[name=destination]").val("").change(),n.find("input[name=n-guideppc]").val(""),n.find("input[name=n-manifest]").val("")},error:function(e){console.log(e)}}))},function(e){return!1})}),$("html").on("click",".edit_packing_guide",function(e){var a=$("#edit_updateDeparturePgModal"),t=$(this).data("send"),n=$(this).data("url"),o=a.find("#edit-updateDeparture-pg-manager-form");$.ajax({url:t,method:"GET",dataType:"JSON",success:function(e){o.attr("action",n);var t=o.find("#edit_pg_form_container");t.html(e.html),a.modal("show")},error:function(e){console.log(e)}})}),$("#edit-updateDeparture-pg-manager-form").on("submit",function(e){e.preventDefault();var a=$(this),t=a.find(".btn-save"),n=t.find(".loadSpinner");t.addClass("disabled"),n.addClass("active"),$.ajax({url:a.attr("action"),data:a.serialize(),method:"POST",dataType:"JSON",success:function(e){var a=$("#edit_updateDeparturePgModal");e.success?Toast.fire({icon:"success",text:e.message}):Toast.fire({icon:"error",text:e.message}),a.modal("hide"),Ge.ajax.reload(null,!1)},complete:function(e){t.removeClass("disabled"),n.removeClass("active")},error:function(e){ToastError.fire(),console.log(e)}})})}if($("#daterange-btn-departures-manager").length){let e=$("input#max_date").val(),a=$("input#min_date").val(),t=moment(e,"YYYY-MM-DD HH:mm:ss").add(1,"days"),n=moment(a,"YYYY-MM-DD HH:mm:ss");$("#date-range-input-departures").val(n.format("DD/MM/YYYY")+" - "+t.format("DD/MM/YYYY")),$("#daterange-btn-departures-manager").daterangepicker({startDate:n,endDate:t,showDropdowns:!0},function(e,a){$("#date-range-input-departures").val(e.format("DD/MM/YYYY")+" - "+a.format("DD/MM/YYYY")),va.draw()})}if($("#departures-table-manager").length){var ca=$("#ppc_guide_select");ca.select2({placeholder:"Selecciona una guía PPC",allowClear:!0});var ma=$("#manifest_select");ma.select2({placeholder:"Selecciona un manifiesto",allowClear:!0});var ua=$("#waste_departure_select");ua.select2({placeholder:"Selecciona un registro de salida",allowClear:!0});var pa=$("#transport_select");pa.select2({placeholder:"Selecciona un transporte",allowClear:!0});ta=$("#destination_select");ta.select2({placeholder:"Selecciona un destino",allowClear:!0});var ga=$("#guide_gc_select");ga.select2({placeholder:"Selecciona una Guía GC Puerto",allowClear:!0});var fa=$("#waste_name_select");fa.select2({placeholder:"Selecciona un residuo",allowClear:!0}),$("input[name=filter-departures-stat-arrival]").on("change",function(){va.column(14).search($(this).val()).draw()}),$("select[name=ppc_guide_select]").on("change",function(){va.column(1).search($(this).val(),{exact:!0}).draw()}),$("select[name=manifest_select]").on("change",function(){va.column(2).search($(this).val(),{exact:!0}).draw()}),$("select[name=waste_departure_select]").on("change",function(){va.column(3).search($(this).val(),{exact:!0}).draw()}),$("select[name=transport_select]").on("change",function(){va.column(7).search($(this).val(),{exact:!0}).draw()}),$("select[name=destination_select]").on("change",function(){va.column(8).search($(this).val(),{exact:!0}).draw()}),$("select[name=guide_gc_select]").on("change",function(){va.column(10).search($(this).val(),{exact:!0}).draw()}),$("select[name=waste_name_select]").on("change",function(){va.column(5).search($(this).val(),{exact:!0}).draw()}),$("html").on("click",".checkbox-waste-label",function(){var e=$("#"+$(this).attr("for")),a=[],t=!1,n=!1;e.is(":checked")||a.push(e.data("status-arrival")),$('input[name="departures-selected[]"]:checked').each(function(){$(this).attr("id")!=e.attr("id")&&a.push($(this).data("status-arrival"))}),$.each(a,function(e,a){if(1==a)return t=!1,!1;t=!0}),$.each(a,function(e,a){if(0==a)return n=!1,!1;n=!0});var o=$("#btn-register-arrival-container"),r=$("#btn-register-departure-container");t?o.html('<button id="btn-register-arrival-modal" class="btn btn-primary">                                         <i class="fa-solid fa-square-plus"></i> &nbsp; <span class="me-1"> Dar llegada </span>                                         <i class="fa-solid fa-spinner fa-spin loadSpinner"></i>                                     </button>'):o.html('<div class="btn btn-secondary" style="pointer-events: none;">                                         <i class="fa-solid fa-square-plus"></i> &nbsp; <span class="me-1"> Dar llegada </span>                                    </div>'),n?r.html('<button id="btn-register-departure-modal" class="btn btn-primary">                                                 <i class="fa-solid fa-square-plus"></i> &nbsp; <span class="me-1"> Dar salida </span>                                                 <i class="fa-solid fa-spinner fa-spin loadSpinner"></i>                                             </button>'):r.html('<div class="btn btn-secondary" style="pointer-events: none;">                                                 <i class="fa-solid fa-square-plus"></i> &nbsp; <span class="me-1"> Dar salida </span>                                            </div>')});var ha=$("#departures-table-manager"),va=(o=ha.data("url"),ha.DataTable({responsive:!0,order:[[9,"desc"]],language:DataTableEs,ajax:{url:o},columns:[{data:"choose",name:"choose",orderable:!1,searchable:!1,className:"not-export-col"},{data:"ppc_code",name:"ppc_code"},{data:"manifest_code",name:"manifest_code"},{data:"cod_guide",name:"cod_guide"},{data:"waste_class",name:"waste_class"},{data:"waste_type",name:"waste_type"},{data:"total_weight",name:"total_weight"},{data:"shipping_type",name:"shipping_type"},{data:"destination",name:"destination"},{data:"date_departure",name:"date_departure"},{data:"gc_code",name:"gc_code"},{data:"date_arrival",name:"date_arrival"},{data:"date_retirement",name:"date_retirement"},{data:"status",name:"status"},{data:"stat_arrival",name:"stat_arrival"}],dom:"Bfrtlip",buttons:[{text:'<i class="fa-solid fa-download"></i> &nbsp; Descargar Excel',extend:"excelHtml5",exportOptions:{columns:":not(.not-export-col)"},title:function(){var e=$("#daterange-btn-departures-manager").data("daterangepicker").startDate.format("YYYY-MM-DD"),a=$("#daterange-btn-departures-manager").data("daterangepicker").endDate.format("YYYY-MM-DD"),t=$("#excel-generated-departures-info").data("name");return"1970-01-01"==e&&(e="El principio",a="El final"),"DETALLE TRANSPORTE - GESTOR: "+t+" - DESDE: "+e+" - HASTA: "+a},filename:function(){var e=$("#daterange-btn-departures-manager").data("daterangepicker").startDate.format("YYYY-MM-DD"),a=$("#daterange-btn-departures-manager").data("daterangepicker").endDate.format("YYYY-MM-DD"),t=$("#excel-generated-departures-info").data("name");return"1970-01-01"==e&&(e="todos",a="todos"),"detalle-transporte_gestor-"+t+"_"+e+"_"+a+"_"+moment().format("hh-mm-ss")}}],initComplete:function(){$.fn.dataTable.ext.search.push(function(e,a,t){if("departures-table-manager"!==e.nTable.id)return!0;var n=moment($("#daterange-btn-departures-manager").data("daterangepicker").startDate.format("YYYY-MM-DD")).toDate(),o=moment($("#daterange-btn-departures-manager").data("daterangepicker").endDate.format("YYYY-MM-DD")).toDate(),r=moment(a[9]).toDate();return null==n&&null==o||(null==n&&r<=o||(null==o&&r>=n||r<=o&&r>=n))})}}));va.on("draw.dt",function(){var e=$("#btn-register-arrival-container"),a=$("#btn-register-departure-container");e.html('<div class="btn btn-secondary" style="pointer-events: none;">                                         <i class="fa-solid fa-square-plus"></i> &nbsp; <span class="me-1"> Dar llegada </span>                                </div>'),a.html('<div class="btn btn-secondary" style="pointer-events: none;">                                             <i class="fa-solid fa-square-plus"></i> &nbsp; <span class="me-1"> Dar salida </span>                                        </div>'),$('input[name="departures-selected[]"]:checked').each(function(){$(this).prop("checked",!1)});let t=$("#total_weight_count_departure"),n=t.data("url");var o=$("#daterange-btn-departures-manager").data("daterangepicker").startDate.format("YYYY-MM-DD"),r=$("#daterange-btn-departures-manager").data("daterangepicker").endDate.format("YYYY-MM-DD"),s=o==r;$.ajax({url:n,method:"GET",data:{table:"departure",from_date:s?null:o,end_date:s?null:r,status:$("input[name=filter-departures-stat-arrival]:checked").val(),ppc_guide:$("select[name=ppc_guide_select]").val(),manifest:$("select[name=manifest_select]").val(),waste_departure:$("select[name=waste_departure_select]").val(),transport:$("select[name=transport_select]").val(),destination:$("select[name=destination_select]").val(),guide_gc:$("select[name=guide_gc_select]").val(),waste:$("select[name=waste_name_select]").val()},success:function(e){t.val(e.value)},error:function(e){console.log(e)}})}),$("html").on("click",".btn-show-packingGuide",function(e){e.preventDefault();var a=$(this),t=a.data("url"),n=$("#showPackingGuideDetailModal"),o=$("#t-body-show-packing-guide-manager"),r=$("#t-body-int-guides-manager");o.html(""),r.html(""),$.ajax({type:"GET",url:t,data:{table:"packingGuide"},dataType:"JSON",success:function(e){o.html(e.html_pg),r.html(e.html_wastes),n.modal("show")},error:function(e){console.log(e)}})}),$("html").on("click","#btn-register-arrival-modal",function(){var e=$(this),a=$("#RegisterArrivalModal"),t=e.find(".loadSpinner"),n=[],o=$("#btn-register-arrival-container").data("url"),r=$("#t-body-arrival-wastes-manager");t.toggleClass("active"),r.html(""),$('input[name="departures-selected[]"]:checked').each(function(){n.push($(this).val())}),$.ajax({type:"GET",url:o,data:{values:n,table:"arrival"},dataType:"JSON",success:function(e){r.html(e.html),a.modal("show")},complete:function(e){t.toggleClass("active")},error:function(e){console.log(e)}})}),$("#register-arrival-form").on("submit",function(e){e.preventDefault();var a=$(this),t=a.find(".loadSpinner"),n=a.attr("action"),o=$("#RegisterArrivalModal"),r=$("#btn-register-arrival-container");Swal.fire({title:"Confirmar",text:"¡Esta acción no se podrá deshacer!",icon:"info",showCancelButton:!0,confirmButtonText:"Registrar",cancelButtonText:"Cancelar",reverseButtons:!0}).then(e=>{e.isConfirmed&&(t.toggleClass("active"),$.ajax({method:a.attr("method"),url:n,data:a.serialize(),dataType:"JSON",success:function(e){Swal.fire({toast:!0,icon:"success",text:"¡Registrado exitosamente!",position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.addEventListener("mouseenter",Swal.stopTimer),e.addEventListener("mouseleave",Swal.resumeTimer)}}),r.html('<div class="btn btn-secondary" style="pointer-events: none;">                                                 <i class="fa-solid fa-square-plus"></i> &nbsp; Dar llegada                                             </div>'),va.ajax.reload(null,!1),t.toggleClass("active"),o.modal("hide"),o.find("input[name=n-guide-gc]").val("")},error:function(e){console.log(e)}}))},function(e){return!1})}),$("html").on("click",".checkbox-wastes-disposition",function(){var e=$("#"+$(this).attr("for")),a=[],t=$(this).closest("form"),n=!1;e.is(":checked")||a.push($(this).data("status-disposition")),$('input[name="wastes-disposition-selected[]"]:checked').each(function(){$(this).attr("id")!=e.attr("id")&&a.push($(this).data("status-disposition"))}),$.each(a,function(e,a){if(1==a)return n=!1,!1;n=!0});var o=t.find("button[type=submit]");n?o.removeClass("disabled"):o.addClass("disabled")}),$("html").on("click","#btn-register-departure-modal",function(){var e=$(this),a=$("#RegisterDepartureModal"),t=a.find("button[type=submit]"),n=e.find(".loadSpinner"),o=[],r=$("#btn-register-departure-container").data("url"),s=a.find("#wastes-selected-departure-manager-table");n.toggleClass("active"),s.html(""),t.addClass("disabled"),$('input[name="departures-selected[]"]:checked').each(function(){o.push($(this).val())}),$.ajax({type:"GET",url:r,data:{values:o},dataType:"JSON",success:function(e){s.html(e.html),a.modal("show")},complete:function(e){n.toggleClass("active")},error:function(e){console.log(e)}})}),$("#register-departure-form").on("submit",function(e){e.preventDefault();var a=$(this),t=a.find(".loadSpinner"),n=a.attr("action"),o=$("#RegisterDepartureModal"),r=$("#btn-register-departure-container");Swal.fire({title:"Confirmar",text:"¡Esta acción no se podrá deshacer!",icon:"info",showCancelButton:!0,confirmButtonText:"Registrar",cancelButtonText:"Cancelar",reverseButtons:!0}).then(e=>{e.isConfirmed&&(t.toggleClass("active"),$.ajax({method:a.attr("method"),url:n,data:a.serialize(),dataType:"JSON",success:function(e){Swal.fire({toast:!0,icon:"success",text:"¡Registrado exitosamente!",position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.addEventListener("mouseenter",Swal.stopTimer),e.addEventListener("mouseleave",Swal.resumeTimer)}}),r.html('<div class="btn btn-secondary" style="pointer-events: none;">                                                 <i class="fa-solid fa-square-plus"></i> &nbsp; Dar salida                                             </div>'),va.ajax.reload(null,!1),o.modal("hide"),o.find("input[name=destination]").val(""),o.find("input[name=plate]").val(""),o.find("input[name=n-green-care-guide]").val(""),o.find("input[name=retrieved-weight]").val(""),o.find("input[name=weight-diff]").val("")},complete:function(e){t.toggleClass("active")},error:function(e){console.log(e)}}))},function(e){return!1})})}if($("#daterange-btn-dispositions-manager").length){let e=$("input#max_date").val(),a=$("input#min_date").val(),t=moment(e,"YYYY-MM-DD HH:mm:ss").add(1,"days"),n=moment(a,"YYYY-MM-DD HH:mm:ss");$("#date-range-input-dispositions").val(n.format("DD/MM/YYYY")+" - "+t.format("DD/MM/YYYY")),$("#daterange-btn-dispositions-manager").daterangepicker({startDate:n,endDate:t},function(e,a){$("#date-range-input-dispositions").val(e.format("DD/MM/YYYY")+" - "+a.format("DD/MM/YYYY")),ya.draw()})}if($("#dispositions-table-manager").length){var wa=$("#guide_gc_select");wa.select2({placeholder:"Selecciona una Guía Green Care",allowClear:!0});var $a=$("#destination_select");$a.select2({placeholder:"Selecciona un destino",allowClear:!0});var ba=$("#plate_select");ba.select2({placeholder:"Selecciona una placa de camión",allowClear:!0});var _a=$("#waste_name_select");_a.select2({placeholder:"Selecciona un residuo",allowClear:!0}),$("input[name=filter-departures-stat-disposition]").on("change",function(){ya.column(19).search($(this).val()).draw()}),$("select[name=guide_gc_select]").on("change",function(){ya.column(1).search($(this).val(),{exact:!0}).draw()}),$("select[name=destination_select]").on("change",function(){ya.column(5).search($(this).val(),{exact:!0}).draw()}),$("select[name=plate_select]").on("change",function(){ya.column(6).search($(this).val(),{exact:!0}).draw()}),$("select[name=waste_name_select]").on("change",function(){ya.column(3).search($(this).val(),{exact:!0}).draw()}),$("html").on("click",".checkbox-waste-label",function(){var e=$("#"+$(this).attr("for")),a=[],t=!1;e.is(":checked")||a.push(e.data("status-disposition")),$('input[name="dispositions-selected[]"]:checked').each(function(){$(this).attr("id")!=e.attr("id")&&a.push($(this).data("status-disposition"))}),$.each(a,function(e,a){if(1==a)return t=!1,!1;t=!0});var n=$("#btn-register-disposition-container");t?n.html('<button id="btn-register-disposition-modal" class="btn btn-primary">                                         <i class="fa-solid fa-square-plus"></i> &nbsp; <span class="me-1"> Disposición </span>                                         <i class="fa-solid fa-spinner fa-spin loadSpinner"></i>                                     </button>'):n.html('<div class="btn btn-secondary" style="pointer-events: none;">                                         <i class="fa-solid fa-square-plus"></i> &nbsp; <span class="me-1"> Disposición </span>                                    </div>')});var Sa=$("#dispositions-table-manager"),ya=(o=Sa.data("url"),Sa.DataTable({responsive:!0,order:[[8,"desc"]],language:DataTableEs,ajax:{url:o},columns:[{data:"choose",name:"choose",orderable:!1,searchable:!1,className:"not-export-col"},{data:"code_green_care",name:"code_green_care"},{data:"waste_class",name:"waste_class"},{data:"waste_type",name:"waste_type"},{data:"total_weight",name:"total_weight"},{data:"destination",name:"destination"},{data:"plate_init",name:"plate_init"},{data:"weigth_init",name:"weigth_init"},{data:"date_departure",name:"date_departure"},{data:"code_dff",name:"code_dff"},{data:"weigth",name:"weigth"},{data:"weigth_diff",name:"weigth_diff"},{data:"disposition_place",name:"disposition_place"},{data:"code_invoice",name:"code_invoice"},{data:"code_certification",name:"code_certification"},{data:"plate",name:"plate"},{data:"managment_report",name:"managment_report"},{data:"observations",name:"observations"},{data:"date_dff",name:"date_dff"},{data:"status",name:"status"}],columnDefs:[],dom:"Bfrtlip",buttons:[{text:'<i class="fa-solid fa-download"></i> &nbsp; Descargar Excel',extend:"excelHtml5",exportOptions:{columns:":not(.not-export-col)"},title:function(){var e=$("#daterange-btn-dispositions-manager").data("daterangepicker").startDate.format("YYYY-MM-DD"),a=$("#daterange-btn-dispositions-manager").data("daterangepicker").endDate.format("YYYY-MM-DD"),t=$("#excel-generated-departures-info").data("name");return"1970-01-01"==e&&(e="El principio",a="El final"),"DETALLE DISPOSICIÓN - GESTOR: "+t+" - DESDE: "+e+" - HASTA: "+a},filename:function(){var e=$("#daterange-btn-dispositions-manager").data("daterangepicker").startDate.format("YYYY-MM-DD"),a=$("#daterange-btn-dispositions-manager").data("daterangepicker").endDate.format("YYYY-MM-DD"),t=$("#excel-generated-departures-info").data("name");return"1970-01-01"==e&&(e="todos",a="todos"),"detalle-disposición_gestor-"+t+"_"+e+"_"+a+"_"+moment().format("hh-mm-ss")}}],initComplete:function(){$.fn.dataTable.ext.search.push(function(e,a,t){if("dispositions-table-manager"!==e.nTable.id)return!0;var n=moment($("#daterange-btn-dispositions-manager").data("daterangepicker").startDate.format("YYYY-MM-DD")).toDate(),o=moment($("#daterange-btn-dispositions-manager").data("daterangepicker").endDate.format("YYYY-MM-DD")).toDate(),r=moment(a[8]).toDate();return null==n&&null==o||(null==n&&r<=o||(null==o&&r>=n||r<=o&&r>=n))})}}));ya.on("draw.dt",function(){var e=$("#btn-register-disposition-container");e.html('<div class="btn btn-secondary" style="pointer-events: none;">                                         <i class="fa-solid fa-square-plus"></i> &nbsp; <span class="me-1"> Disposición </span>                                </div>'),$('input[name="dispositions-selected[]"]:checked').each(function(){$(this).prop("checked",!1)});let a=$("#total_weight_count_disposition"),t=a.data("url");var n=$("#daterange-btn-dispositions-manager").data("daterangepicker").startDate.format("YYYY-MM-DD"),o=$("#daterange-btn-dispositions-manager").data("daterangepicker").endDate.format("YYYY-MM-DD"),r=n==o;$.ajax({url:t,method:"GET",data:{table:"disposition",from_date:r?null:n,end_date:r?null:o,status:$("input[name=filter-departures-stat-disposition]:checked").val(),guide_gc:$("select[name=guide_gc_select]").val(),destination:$("select[name=destination_select]").val(),plate:$("select[name=plate_select]").val(),waste:$("select[name=waste_name_select]").val()},success:function(e){a.val(e.value)},error:function(e){console.log(e)}})}),$("html").on("click","#btn-register-disposition-modal",function(){var e=$(this),a=$("#RegisterDispositionModal"),t=e.find(".loadSpinner"),n=[],o=$("#btn-register-disposition-container").data("url"),r=$("#t-body-disposition-wastes-manager");t.toggleClass("active"),r.html(""),$('input[name="dispositions-selected[]"]:checked').each(function(){n.push($(this).val())}),$.ajax({type:"GET",url:o,data:{values:n},dataType:"JSON",success:function(e){$.each(e.dispositions,function(e,a){r.append('<tr>                                         <input name="disposition-ids[]" type="hidden" value="'+a.id+'">                                         <td>'+a.code_green_care+"</td>                                         <td>"+a.destination+"</td>                                         <td>"+a.plate_init+"</td>                                         <td>"+a.weigth_init+"</td>                                         <td>"+a.date_departure+"</td>                                     </tr>")});var t=$("#total-weight-disposition-manager");t.text(e.total_weight),a.modal("show")},complete:function(e){t.toggleClass("active")},error:function(e){console.log(e)}})}),$("#register-disposition-form").on("submit",function(e){e.preventDefault();var a=$(this),t=a.find(".loadSpinner"),n=a.attr("action"),o=$("#RegisterDispositionModal"),r=$("#btn-register-disposition-container");Swal.fire({title:"Confirmar",text:"¡Esta acción no se podrá deshacer!",icon:"info",showCancelButton:!0,confirmButtonText:"Registrar",cancelButtonText:"Cancelar",reverseButtons:!0}).then(e=>{e.isConfirmed&&(t.toggleClass("active"),$.ajax({method:a.attr("method"),url:n,data:a.serialize(),dataType:"JSON",success:function(e){Swal.fire({toast:!0,icon:"success",text:"¡Registrado exitosamente!",position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.addEventListener("mouseenter",Swal.stopTimer),e.addEventListener("mouseleave",Swal.resumeTimer)}}),r.html('<div class="btn btn-secondary" style="pointer-events: none;">                                                 <i class="fa-solid fa-square-plus"></i> &nbsp; Disposición                                             </div>'),ya.ajax.reload(null,!1),o.modal("hide"),o.find("input[name=n-ddff-guide]").val(""),o.find("input[name=ddff-weight]").val(""),o.find("input[name=weight-diff]").val(""),o.find("select[name=disposition-place]").val("").change(),o.find("input[name=n-invoice]").val(""),o.find("input[name=n-certification]").val(""),o.find("input[name=plate]").val(""),o.find("input[name=report]").val(""),o.find("input[name=observation]").val("")},complete:function(e){t.toggleClass("active")},error:function(e){console.log(e)}}))},function(e){return!1})}),$("html").on("click",".btn-show-disposition",function(e){e.preventDefault();var a=$(this).data("url"),t=$("#showDispositionDetailModal"),n=t.find("#disposition_detail_content");$.ajax({type:"GET",url:a,dataType:"JSON",success:function(e){n.html(e.html),t.modal("show")},error:function(e){console.log(e)}})})}$("input:checkbox.check_options").on("click",function(e){let a=$(this),t=a.prop("checked"),n=a.closest(".form-group").find(".options_items input:checkbox.selectgroup-input");n.each(function(){t?$(this).prop("checked",!0):$(this).prop("checked",!1)})})});